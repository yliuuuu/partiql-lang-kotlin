<!DOCTYPE html>
<html  dir="ltr">

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>PartiQL User Guide</title>
        <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
        <link rel="apple-touch-icon-precomposed" href="images/apple-touch-icon.png">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/uikit/2.26.4/css/uikit.gradient.css">

        <link rel="stylesheet" href="style.css">
        <script src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
        <script src="uikit.js"></script>
        <script src="scripts.js"></script>
        <script src="jquery.sticky-kit.js "></script>

        <meta name="generator" content="pandoc-uikit" />
                <meta name="author" content="Ion Team" />
                        <title>PartiQL User Guide</title>
        <style type="text/css">code{white-space: pre;}</style>
                        <style type="text/css">
            pre > code.sourceCode { white-space: pre; position: relative; }
            pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
            pre > code.sourceCode > span:empty { height: 1.2em; }
            code.sourceCode > span { color: inherit; text-decoration: inherit; }
            div.sourceCode { margin: 1em 0; }
            pre.sourceCode { margin: 0; }
            @media screen {
            div.sourceCode { overflow: auto; }
            }
            @media print {
            pre > code.sourceCode { white-space: pre-wrap; }
            pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
            }
            pre.numberSource code
              { counter-reset: source-line 0; }
            pre.numberSource code > span
              { position: relative; left: -4em; counter-increment: source-line; }
            pre.numberSource code > span > a:first-child::before
              { content: counter(source-line);
                position: relative; left: -1em; text-align: right; vertical-align: baseline;
                border: none; display: inline-block;
                -webkit-touch-callout: none; -webkit-user-select: none;
                -khtml-user-select: none; -moz-user-select: none;
                -ms-user-select: none; user-select: none;
                padding: 0 4px; width: 4em;
                color: #aaaaaa;
              }
            pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
            div.sourceCode
              {   }
            @media screen {
            pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
            }
            code span.al { color: #ff0000; font-weight: bold; } /* Alert */
            code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
            code span.at { color: #7d9029; } /* Attribute */
            code span.bn { color: #40a070; } /* BaseN */
            code span.bu { } /* BuiltIn */
            code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
            code span.ch { color: #4070a0; } /* Char */
            code span.cn { color: #880000; } /* Constant */
            code span.co { color: #60a0b0; font-style: italic; } /* Comment */
            code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
            code span.do { color: #ba2121; font-style: italic; } /* Documentation */
            code span.dt { color: #902000; } /* DataType */
            code span.dv { color: #40a070; } /* DecVal */
            code span.er { color: #ff0000; font-weight: bold; } /* Error */
            code span.ex { } /* Extension */
            code span.fl { color: #40a070; } /* Float */
            code span.fu { color: #06287e; } /* Function */
            code span.im { } /* Import */
            code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
            code span.kw { color: #007020; font-weight: bold; } /* Keyword */
            code span.op { color: #666666; } /* Operator */
            code span.ot { color: #007020; } /* Other */
            code span.pp { color: #bc7a00; } /* Preprocessor */
            code span.sc { color: #4070a0; } /* SpecialChar */
            code span.ss { color: #bb6688; } /* SpecialString */
            code span.st { color: #4070a0; } /* String */
            code span.va { color: #19177c; } /* Variable */
            code span.vs { color: #4070a0; } /* VerbatimString */
            code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
        </style>
                        <link rel="stylesheet" href="style.css" />
                                             
    </head>

    <body>


        <div class="uk-container uk-container-center uk-margin-top uk-margin-large-bottom">

                        <div class="uk-grid" data-uk-grid-margin>
                <div class="uk-width-1-1">
                    <h1 class="uk-heading-large">PartiQL User Guide</h1>
                                        <p class="uk-text-large">Ion Team</p>
                                    </div>
            </div>
            
            <div class="uk-grid" data-uk-grid-margin >          
                <div class="uk-width-medium-1-4">
                    <div class="uk-overflow-container" data-uk-sticky="{top:25,media: 768}">
                        <div class="uk-panel uk-panel-box menu-begin" >

                                                        <ul>
                                                        <li><a href="#preface">Preface</a>
                                                        <ul>
                                                        <li><a href="#what-is-partiql">What is PartiQL</a></li>
                                                        <li><a href="#conventions">Conventions</a></li>
                                                        <li><a href="#further-reading">Further Reading</a></li>
                                                        <li><a href="#bug-reports">Bug Reports</a></li>
                                                        <li><a href="#contribute">Contribute</a></li>
                                                        </ul></li>
                                                        <li><a href="#faq">FAQ</a></li>
                                                        <li><a href="#getting-started">Getting Started</a>
                                                        <ul>
                                                        <li><a href="#prerequisites">Prerequisites</a></li>
                                                        <li><a href="#download-the-partiql-repl">Download the PartiQL REPL</a></li>
                                                        <li><a href="#running-the-partiql-repl">Running the PartiQL REPL</a>
                                                        <ul>
                                                        <li><a href="#windows">Windows</a></li>
                                                        <li><a href="#macos-mac-and-unix">macOS (Mac) and Unix</a></li>
                                                        </ul></li>
                                                        <li><a href="#testing-the-partiql-repl">Testing the PartiQL REPL</a></li>
                                                        <li><a href="#loading-data-from-a-file">Loading data from a file</a></li>
                                                        </ul></li>
                                                        <li><a href="#partiql-cli">PartiQL CLI</a></li>
                                                        <li><a href="#building-the-cli">Building the CLI</a></li>
                                                        <li><a href="#using-the-cli">Using the CLI</a></li>
                                                        <li><a href="#repl">REPL</a>
                                                        <ul>
                                                        <li><a href="#advanced-repl-features">Advanced REPL Features</a></li>
                                                        <li><a href="#initial-environment">Initial Environment</a></li>
                                                        </ul></li>
                                                        <li><a href="#working-with-structure">Working with Structure</a></li>
                                                        <li><a href="#readingwriting-files">Reading/Writing Files</a></li>
                                                        <li><a href="#tsvcsv-data">TSV/CSV Data</a>
                                                        <ul>
                                                        <li><a href="#predefined-csv-data">Predefined CSV Data</a></li>
                                                        <li><a href="#customized-csv-data">Customized CSV Data</a></li>
                                                        <li><a href="#permissive-typing-mode">Permissive Typing Mode</a></li>
                                                        </ul></li>
                                                        <li><a href="#partiql-tutorial">PartiQL Tutorial</a></li>
                                                        <li><a href="#partiql-user-guide">PartiQL User Guide</a>
                                                        <ul>
                                                        <li><a href="#introduction">Introduction</a></li>
                                                        <li><a href="#data-types">Data Types</a>
                                                        <ul>
                                                        <li><a href="#decimal">Decimal</a></li>
                                                        </ul></li>
                                                        <li><a href="#built-in-functions">Built-in Functions</a>
                                                        <ul>
                                                        <li><a href="#unknown-null-and-missing-propagation">Unknown (<code>null</code> and <code>missing</code>) propagation</a></li>
                                                        <li><a href="#cast">CAST</a></li>
                                                        <li><a href="#char_length-character_length">CHAR_LENGTH, CHARACTER_LENGTH</a></li>
                                                        <li><a href="#coalesce">COALESCE</a></li>
                                                        <li><a href="#date_add">DATE_ADD</a></li>
                                                        <li><a href="#date_diff">DATE_DIFF</a></li>
                                                        <li><a href="#exists">EXISTS</a></li>
                                                        <li><a href="#extract">EXTRACT</a></li>
                                                        <li><a href="#lower">LOWER</a></li>
                                                        <li><a href="#make_date">MAKE_DATE</a></li>
                                                        <li><a href="#make_time">MAKE_TIME</a></li>
                                                        <li><a href="#size">SIZE</a></li>
                                                        <li><a href="#nullif">NULLIF</a></li>
                                                        <li><a href="#substring">SUBSTRING</a></li>
                                                        <li><a href="#to_string">TO_STRING</a></li>
                                                        <li><a href="#to_timestamp">TO_TIMESTAMP</a></li>
                                                        <li><a href="#trim">TRIM</a></li>
                                                        <li><a href="#upper">UPPER</a></li>
                                                        <li><a href="#utcnow">UTCNOW</a></li>
                                                        <li><a href="#unix_timestamp">UNIX_TIMESTAMP</a></li>
                                                        <li><a href="#from_unixtime">FROM_UNIXTIME</a></li>
                                                        </ul></li>
                                                        </ul></li>
                                                        <li><a href="#references">References</a></li>
                                                        </ul>
                            
                        </div>
                    </div>
                </div>

                <div class="uk-width-medium-3-4">
<h1 id="preface">Preface</h1>
<p>The user’s guide provides an explanation of the features implemented by PartiQL’s kotlin implementation.</p>
<p><em>This document is an early draft, contributions welcome!</em></p>
<h2 id="what-is-partiql">What is PartiQL</h2>
<p>PartiQL is an implementation of <a href="http://db.ucsd.edu/wp-content/uploads/pdfs/375.pdf">SQL++</a> based upon <a href="http://amzn.github.io/ion-docs/">Ion’s</a> type system. PartiQL is based on SQL92 and provides support for working with schemaless hierarchical data.</p>
<h2 id="conventions">Conventions</h2>
<p><em>TBD</em></p>
<h2 id="further-reading">Further Reading</h2>
<ul>
<li><a href="http://db.ucsd.edu/wp-content/uploads/pdfs/375.pdf">SQL++</a></li>
<li><a href="http://amzn.github.io/ion-docs/">Ion’s</a></li>
</ul>
<h2 id="bug-reports">Bug Reports</h2>
<p>We welcome you to use the GitHub issue tracker to report bugs or suggest features.</p>
<p>When filing an issue, please check existing open, or recently closed, issues to make sure somebody else hasn’t already reported the issue. Please try to include as much information as you can. Details like these are incredibly useful:</p>
<ul>
<li>A reproducible test case or series of steps</li>
<li>The version of our code being used</li>
<li>Any modifications you’ve made relevant to the bug</li>
<li>Anything unusual about your environment or deployment</li>
</ul>
<h2 id="contribute">Contribute</h2>
<p>See our <a href="https://github.com/partiql/partiql-lang-kotlin/blob/345a97c3c79c4a2beb8d44185221ee419b82e08a/CONTRIBUTING.md">contribute guide</a>.</p>
<h1 id="faq">FAQ</h1>
<p><em>TBD</em></p>
<h1 id="getting-started">Getting Started</h1>
<p>PartiQL provides an interactive shell, or Read Evaluate Print Loop (REPL), that allows users to write and evaluate PartiQL queries.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>PartiQL requires the Java Runtime (JVM) to be installed on your machine. You can obtain the <em>latest</em> version of the Java Runtime from either</p>
<ol type="1">
<li><a href="https://openjdk.java.net/install/">OpenJDK</a>, or <a href="https://developers.redhat.com/products/openjdk">OpenJDK for Windows</a><br />
</li>
<li><a href="https://www.oracle.com/technetwork/java/javase/downloads/index.html">Oracle</a></li>
</ol>
<p><a href="https://docs.oracle.com/cd/E19182-01/820-7851/inst_cli_jdk_javahome_t/">Follow the instructions on how to set</a> <code>JAVA_HOME</code> to the path where your Java Runtime is installed.</p>
<h2 id="download-the-partiql-repl">Download the PartiQL REPL</h2>
<p>Each release of PartiQL comes with an archive that contains the PartiQL REPL as a zip file.</p>
<ol type="1">
<li><a href="https://github.com/partiql/partiql-lang-kotlin/releases">Download</a>. You may have to click on <code>Assets</code> to see the zip and tgz archives. the latest <code>partiql-cli</code><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> zip archive to your machine.</li>
<li>Expand (unzip) the archive on your machine. Expanding the archive yields the following folder structure:</li>
</ol>
<pre><code>├── partiql-cli
    ├── bin
    │   ├── partiql
    │   └── partiql.bat
    ├── lib
    │   └── ... 
    ├── README.md
    └── Tutorial
        ├── code
        │   └── ... 
        ├── tutorial.html
        └── tutorial.pdf</code></pre>
<p>where <code>...</code> represents elided files/directories.</p>
<p>The root folder <code>partiql-cli</code> contains a <code>README.md</code> file and 3 subfolders</p>
<ol type="1">
<li>The folder <code>bin</code> contains startup scripts <code>partiql</code> for macOS and Unix systems and <code>partiql.bat</code> for Windows systems. Execute these files to start the REPL.</li>
<li>The folder <code>lib</code> contains all the necessary Java libraries needed to run PartiQL.</li>
<li>The folder <code>Tutorial</code> contains the tutorial in <code>pdf</code> and <code>html</code> form. The subfolder <code>code</code> contains 3 types of files:
<ol type="1">
<li>Data files with the extension <code>.env</code>. These files contains PartiQL data that we can query.</li>
<li>PartiQL query files with the extension <code>.sql</code>. These files contain the PartiQL queries used in the tutorial.</li>
<li>Sample query output files with the extension <code>.output</code>. These files contain sample output from running the tutorial queries on the appropriate data.</li>
</ol></li>
</ol>
<h2 id="running-the-partiql-repl">Running the PartiQL REPL</h2>
<h3 id="windows">Windows</h3>
<p>Run (double click on) <code>partiql.bat</code>. This should open a command-line prompt and start the PartiQL REPL which displays:</p>
<pre><code>Welcome to the PartiQL REPL!
PartiQL&gt; </code></pre>
<h3 id="macos-mac-and-unix">macOS (Mac) and Unix</h3>
<ol type="1">
<li>Open a terminal and navigate to the <code>partiql-cli</code><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> folder.</li>
<li>Start the REPL by typing <code>./bin/partiql</code> and pressing ENTER, which displays:</li>
</ol>
<pre><code>Welcome to the PartiQL REPL!
PartiQL&gt;</code></pre>
<h2 id="testing-the-partiql-repl">Testing the PartiQL REPL</h2>
<p>Let’s write a simple query to verify that our PartiQL REPL is working. At the <code>PartiQL&gt;</code> prompt type:</p>
<pre><code>PartiQL&gt; SELECT * FROM [1,2,3]</code></pre>
<p>and press <code>ENTER</code> <em>twice</em>. The output should look similar to:</p>
<pre><code>PartiQL&gt; SELECT * FROM [1,2,3]
   | 
===&#39; 
&lt;&lt;
  {
    &#39;_1&#39;: 1
  },
  {
    &#39;_1&#39;: 2
  },
  {
    &#39;_1&#39;: 3
  }
&gt;&gt;
--- 
OK!
PartiQL&gt; </code></pre>
<p>Congratulations! You successfully installed and run the PartiQL REPL. The PartiQL REPL is now waiting for more input.</p>
<p>To exit the PartiQL REPL, press:</p>
<ul>
<li><code>Control+D</code> in macOS or Unix</li>
<li><code>Control+C</code> on Windows</li>
</ul>
<p>or close the terminal/command prompt window.</p>
<h2 id="loading-data-from-a-file">Loading data from a file</h2>
<p>An easy way to load the necessary data into the REPL is use the <code>-e</code> switch when starting the REPL and provide the name of a file that contains your data.</p>
<pre><code>./bin/partiql  -e Tutorial/code/q1.env</code></pre>
<p>You can then see what is loaded in the REPL’s global environment using the <strong>special</strong> REPL command <code>!global_env</code>, i.e.,</p>
<pre><code>Welcome to the PartiQL REPL!
PartiQL&gt; !global_env
   | 
===&#39; 
{
  &#39;hr&#39;: {
    &#39;employees&#39;: &lt;&lt;
      {
        &#39;id&#39;: 3,
        &#39;name&#39;: &#39;Bob Smith&#39;,
        &#39;title&#39;: NULL
      },
      {
        &#39;id&#39;: 4,
        &#39;name&#39;: &#39;Susan Smith&#39;,
        &#39;title&#39;: &#39;Dev Mgr&#39;
      },
      {
        &#39;id&#39;: 6,
        &#39;name&#39;: &#39;Jane Smith&#39;,
        &#39;title&#39;: &#39;Software Eng 2&#39;
      }
    &gt;&gt;
  }
}
--- 
OK!
</code></pre>
<h1 id="partiql-cli">PartiQL CLI</h1>
<pre><code>PartiQL CLI
Command line interface for executing PartiQL queries. Can be run in an interactive (REPL) mode or non-interactive.

Examples:
To run in REPL mode simply execute the executable without any arguments:
     partiql

In non-interactive mode we use Ion as the format for input data which is bound to a global variable
named &quot;input_data&quot;, in the example below /logs/log.ion is bound to &quot;input_data&quot;:
     partiql --query=&quot;SELECT * FROM input_data&quot; --input=/logs/log.ion

The cli can output using PartiQL syntax or Ion using the --output-format option, e.g. to output binary ion:
     partiql --query=&quot;SELECT * FROM input_data&quot; --output-format=ION_BINARY --input=/logs/log.ion

To pipe input data in via stdin:
     cat /logs/log.ion | partiql --query=&quot;SELECT * FROM input_data&quot; --format=ION_BINARY &gt; output.10n

Option                                Description
------                                -----------
-e, --environment &lt;File&gt;              initial global environment (optional)
-h, --help                            prints this help
-i, --input &lt;File&gt;                    input file, requires the query option (optional)
-o, --output &lt;File&gt;                   output file, requires the query option (default: stdout)
--of, --output-format &lt;OutputFormat:  output format, requires the query option (default: PARTIQL)
  (ION_TEXT|ION_BINARY|PARTIQL|PARTIQL_PRETTY)&gt;
-p, --permissive                      run the PartiQL query in PERMISSIVE typing mode
-q, --query &lt;String&gt;                  PartiQL query, triggers non interactive mode</code></pre>
<h1 id="building-the-cli">Building the CLI</h1>
<p>The CLI is built during the main Gradle build. To build it separately execute:</p>
<pre><code>./gradlew :cli:build</code></pre>
<p>After building, distributable jars are located in the <code>cli/build/distributions</code> directory (relative to the project root).</p>
<p>Be sure to include the correct relative path to <code>gradlew</code> if you are not in the project root.</p>
<h1 id="using-the-cli">Using the CLI</h1>
<p>The following command will build any dependencies before starting the CLI.</p>
<pre><code>./gradlew :cli:run -q --args=&quot;&lt;command line arguments&gt;&quot;</code></pre>
<h1 id="repl">REPL</h1>
<p>To start an interactive read, eval, print loop (REPL) execute:</p>
<pre><code>rlwrap ./gradlew :cli:run --console=plain</code></pre>
<p><a href="https://github.com/hanslub42/rlwrap">rlwrap</a> provides command history support. It allows the use of the up and down arrow keys to cycle through recently executed commands and remembers commands entered into previous sessions. <code>rlwrap</code> is available as an optional package in all major Linux distributions and in <a href="https://brew.sh/">Homebrew</a> on MacOS. <code>rlwrap</code> is not required but is highly recommended.</p>
<p>You will see a prompt that looks as follows:</p>
<pre><code>Welcome to the PartiQL REPL!
PartiQL&gt; </code></pre>
<p>At this point you can type in SQL and press enter <em>twice</em> to execute it:</p>
<pre><code>PartiQL&gt; SELECT id FROM `[{id: 5, name:&quot;bill&quot;}, {id: 6, name:&quot;bob&quot;}]` WHERE name = &#39;bob&#39;
   |
===&#39;
&lt;&lt;
  {
    &#39;id&#39;: 6
  }
&gt;&gt;
---
OK!</code></pre>
<p>The result of previous expression is stored in the variable named <code>_</code>, so you can then run subsequent expressions based on the last one.</p>
<pre><code>PartiQL&gt; SELECT id + 4 AS name FROM _
   |
===&#39;
&lt;&lt;
  {
    &#39;name&#39;: 10
  }
&gt;&gt;
---
OK!</code></pre>
<p>Press control-D to exit the REPL.</p>
<h2 id="advanced-repl-features">Advanced REPL Features</h2>
<p>To view the AST of an SQL statement, type one and press enter only <em>once</em>, then type <code>!!</code> and press enter:</p>
<pre><code>PartiQL&gt; 1 + 1
   | !!
===&#39;

(
  ast
  (
    version
    1
  )
  (
    root
    (
      +
      (
        lit
        1
      )
      (
        lit
        1
      )
    )
  )
)
---
OK!</code></pre>
<h2 id="initial-environment">Initial Environment</h2>
<p>The initial environment for the REPL can be setup with a configuration file, which should be an PartiQL file with a single <code>struct</code> containing the initial <em>global environment</em>.</p>
<p>For example a file named <code>config.sql</code>, containing the following:</p>
<pre><code>{
  &#39;animals&#39;:[
    {&#39;name&#39;: &#39;Kumo&#39;, &#39;type&#39;: &#39;dog&#39;},
    {&#39;name&#39;: &#39;Mochi&#39;, &#39;type&#39;: &#39;dog&#39;},
    {&#39;name&#39;: &#39;Lilikoi&#39;, &#39;type&#39;: &#39;unicorn&#39;}
  ],
  &#39;types&#39;:[
    {&#39;id&#39;: &#39;dog&#39;, &#39;is_magic&#39;: false},
    {&#39;id&#39;: &#39;cat&#39;, &#39;is_magic&#39;: false},
    {&#39;id&#39;: &#39;unicorn&#39;, &#39;is_magic&#39;: true}
  ]
}</code></pre>
<p>Could be loaded into the REPL with <code>animals</code> and <code>types</code> bound list of <code>struct</code> values.</p>
<p>The REPL could be started up with:</p>
<pre><code>$ ./gradlew :cli:run -q --console=plain --args=&#39;-e config.sql&#39;</code></pre>
<p>(Note that shell expansions such as <code>~</code> do not work within the value of the <code>args</code> argument.)</p>
<p>Or if you have extracted one of the compressed archives:</p>
<pre><code>$ ./bin/partiql -e config.sql</code></pre>
<p>Expressions can then use the environment defined by <code>config.sql</code>:</p>
<pre><code>PartiQL&gt; SELECT name, type, is_magic FROM animals, types WHERE type = id
   |
===&#39;
&lt;&lt;
  {
    &#39;name&#39;: &#39;Kumo&#39;,
    &#39;type&#39;: &#39;dog&#39;,
    &#39;is_magic&#39;: false
  },
  {
    &#39;name&#39;: &#39;Mochi&#39;,
    &#39;type&#39;: &#39;dog&#39;,
    &#39;is_magic&#39;: false
  },
  {
    &#39;name&#39;: &#39;Lilikoi&#39;,
    &#39;type&#39;: &#39;unicorn&#39;,
    &#39;is_magic&#39;: true
  }
&gt;&gt;
---
OK!</code></pre>
<p>To see the current REPL environment you can use <code>!global_env</code>, for example for the file above:</p>
<pre><code>PartiQL&gt; !global_env
   |
===&#39;
{
  &#39;types&#39;: [
    {
      &#39;id&#39;: &#39;dog&#39;,
      &#39;is_magic&#39;: false
    },
    {
      &#39;id&#39;: &#39;cat&#39;,
      &#39;is_magic&#39;: false
    },
    {
      &#39;id&#39;: &#39;unicorn&#39;,
      &#39;is_magic&#39;: true
    }
  ],
  &#39;animals&#39;: [
    {
      &#39;name&#39;: &#39;Kumo&#39;,
      &#39;type&#39;: &#39;dog&#39;
    },
    {
      &#39;name&#39;: &#39;Mochi&#39;,
      &#39;type&#39;: &#39;dog&#39;
    },
    {
      &#39;name&#39;: &#39;Lilikoi&#39;,
      &#39;type&#39;: &#39;unicorn&#39;
    }
  ]
}
---
OK!</code></pre>
<p>You can also add new values to the global environment or replace existing values using <code>!add_to_global_env</code>. The example below replaces the value bound to <code>types</code></p>
<pre><code>PartiQL&gt; !add_to_global_env {&#39;types&#39;: []}
   |
===&#39;
{
  &#39;types&#39;: []
}
---
OK!
PartiQL&gt; !global_env
   |
===&#39;
{
  &#39;types&#39;: [],
  &#39;animals&#39;: [
    {
      &#39;name&#39;: &#39;Kumo&#39;,
      &#39;type&#39;: &#39;dog&#39;
    },
    {
      &#39;name&#39;: &#39;Mochi&#39;,
      &#39;type&#39;: &#39;dog&#39;
    },
    {
      &#39;name&#39;: &#39;Lilikoi&#39;,
      &#39;type&#39;: &#39;unicorn&#39;
    }
  ]
}
---
OK!</code></pre>
<h1 id="working-with-structure">Working with Structure</h1>
<p>Let’s consider the following initial environment:</p>
<pre><code>{
  &#39;stores&#39;:[
    {
     &#39;id&#39;: 5,
     &#39;books&#39;: [
       {&#39;title&#39;:&#39;A&#39;, &#39;price&#39;: 5.0, &#39;categories&#39;:[&#39;sci-fi&#39;, &#39;action&#39;]},
       {&#39;title&#39;:&#39;B&#39;, &#39;price&#39;: 2.0, &#39;categories&#39;:[&#39;sci-fi&#39;, &#39;comedy&#39;]},
       {&#39;title&#39;:&#39;C&#39;, &#39;price&#39;: 7.0, &#39;categories&#39;:[&#39;action&#39;, &#39;suspense&#39;]},
       {&#39;title&#39;:&#39;D&#39;, &#39;price&#39;: 9.0, &#39;categories&#39;:[&#39;suspense&#39;]}
     ]
    },
    {
     &#39;id&#39;: 6,
     &#39;books&#39;: [
       {&#39;title&#39;:&#39;A&#39;, &#39;price&#39;: 5.0, &#39;categories&#39;:[&#39;sci-fi&#39;, &#39;action&#39;]},
       {&#39;title&#39;:&#39;E&#39;, &#39;price&#39;: 9.5, &#39;categories&#39;:[&#39;fantasy&#39;, &#39;comedy&#39;]},
       {&#39;title&#39;:&#39;F&#39;, &#39;price&#39;: 10.0, &#39;categories&#39;:[&#39;history&#39;]}
     ]
    }
  ]
}</code></pre>
<p>Set the environment as below</p>
<pre><code>PartiQL&gt; !add_to_global_env { &#39;stores&#39;:[ { &#39;id&#39;: 5, &#39;books&#39;: [ {&#39;title&#39;:&#39;A&#39;, &#39;price&#39;: 5.0, &#39;categories&#39;:[&#39;sci-fi&#39;, &#39;action&#39;]}, {&#39;title&#39;:&#39;B&#39;, &#39;price&#39;: 2.0, &#39;categories&#39;:[&#39;sci-fi&#39;, &#39;comedy&#39;]}, {&#39;title&#39;:&#39;C&#39;, &#39;price&#39;: 7.0, &#39;categories&#39;:[&#39;action&#39;, &#39;suspense&#39;]}, {&#39;title&#39;:&#39;D&#39;, &#39;price&#39;: 9.0, &#39;categories&#39;:[&#39;suspense&#39;]} ] }, { &#39;id&#39;: 6, &#39;books&#39;: [ {&#39;title&#39;:&#39;A&#39;, &#39;price&#39;: 5.0, &#39;categories&#39;:[&#39;sci-fi&#39;, &#39;action&#39;]}, {&#39;title&#39;:&#39;E&#39;, &#39;price&#39;: 9.5, &#39;categories&#39;:[&#39;fantasy&#39;, &#39;comedy&#39;]}, {&#39;title&#39;:&#39;F&#39;, &#39;price&#39;: 10.0, &#39;categories&#39;:[&#39;history&#39;]} ] } ] }</code></pre>
<p>If we wanted to find all books <em>as their own rows</em> with a price greater than <code>7</code> we can use paths on the <code>FROM</code> for this:</p>
<pre><code>PartiQL&gt; SELECT * FROM stores[*].books[*] AS b WHERE b.price &gt; 7
   |
===&#39;
&lt;&lt;
  {
    &#39;title&#39;: &#39;D&#39;,
    &#39;price&#39;: 9.0,
    &#39;categories&#39;: [
      &#39;suspense&#39;
    ]
  },
  {
    &#39;title&#39;: &#39;E&#39;,
    &#39;price&#39;: 9.5,
    &#39;categories&#39;: [
      &#39;fantasy&#39;,
      &#39;comedy&#39;
    ]
  },
  {
    &#39;title&#39;: &#39;F&#39;,
    &#39;price&#39;: 10.0,
    &#39;categories&#39;: [
      &#39;history&#39;
    ]
  }
&gt;&gt;
---
OK!</code></pre>
<p>If you wanted to also de-normalize the store ID and title into the above rows:</p>
<pre><code>PartiQL&gt; SELECT s.id AS store, b.title AS title FROM stores AS s, @s.books AS b WHERE b.price &gt; 7
   |
===&#39;
&lt;&lt;
  {
    &#39;store&#39;: 5,
    &#39;title&#39;: &#39;D&#39;
  },
  {
    &#39;store&#39;: 6,
    &#39;title&#39;: &#39;E&#39;
  },
  {
    &#39;store&#39;: 6,
    &#39;title&#39;: &#39;F&#39;
  }
&gt;&gt;
---
OK!</code></pre>
<p>We can also use sub-queries with paths to predicate on sub-structure without changing the cardinality. So if we wanted to find all stores with books having prices greater than <code>9.5</code></p>
<pre><code>PartiQL&gt; SELECT * FROM stores AS s
   | WHERE EXISTS(
   |    SELECT * FROM @s.books AS b WHERE b.price &gt; 9.5
   | )
   |
===&#39;
&lt;&lt;
  {
    &#39;id&#39;: 6,
    &#39;books&#39;: [
      {
        &#39;title&#39;: &#39;A&#39;,
        &#39;price&#39;: 5.0,
        &#39;categories&#39;: [
          &#39;sci-fi&#39;,
          &#39;action&#39;
        ]
      },
      {
        &#39;title&#39;: &#39;E&#39;,
        &#39;price&#39;: 9.5,
        &#39;categories&#39;: [
          &#39;fantasy&#39;,
          &#39;comedy&#39;
        ]
      },
      {
        &#39;title&#39;: &#39;F&#39;,
        &#39;price&#39;: 10.0,
        &#39;categories&#39;: [
          &#39;history&#39;
        ]
      }
    ]
  }
&gt;&gt;
---
OK!</code></pre>
<h1 id="readingwriting-files">Reading/Writing Files</h1>
<p>The REPL provides the <code>read_file</code> function to stream data from a file. The files needs to be placed in the folder <code>cli</code>. For example:</p>
<p>Create a file called <code>data.ion</code> in the <code>cli</code> folder with the following contents</p>
<pre><code>{ &#39;city&#39;: &#39;Seattle&#39;, &#39;state&#39;: &#39;WA&#39; }
{ &#39;city&#39;: &#39;Bellevue&#39;, &#39;state&#39;: &#39;WA&#39; }
{ &#39;city&#39;: &#39;Honolulu&#39;, &#39;state&#39;: &#39;HI&#39; }
{ &#39;city&#39;: &#39;Rochester&#39;, &#39;state&#39;: &#39;NY&#39; }</code></pre>
<p>Select the cities that are in <code>HI</code> and <code>NY</code> states</p>
<pre><code>PartiQL&gt; SELECT city FROM read_file(&#39;data.ion&#39;) AS c, `[&quot;HI&quot;, &quot;NY&quot;]` AS s WHERE c.state = s
   | 
===&#39;
&lt;&lt;
  {
    &#39;city&#39;: &#39;Honolulu&#39;
  },
  {
    &#39;city&#39;: &#39;Rochester&#39;
  }
&gt;&gt;
------
OK!</code></pre>
<p>The REPL also has the capability to write files with the <code>write_file</code> function:</p>
<pre><code>PartiQL&gt; write_file(&#39;out.ion&#39;, SELECT * FROM _)
   | 
===&#39;
true
------
OK!</code></pre>
<p>A file called <code>out.ion</code> will be created in the <code>cli</code> directory with the following contents</p>
<pre><code>{
  city:Honolulu
}
{
  city:Rochester
}</code></pre>
<p>Functions and expressions can be used in the <em>global configuration</em> as well. Consider the following <code>config.ion</code>:</p>
<pre><code>{
  &#39;data&#39;: read_file(&#39;data.ion&#39;)
}</code></pre>
<p>The <code>data</code> variable will now be bound to file containing Ion:</p>
<pre><code>PartiQL&gt; SELECT * FROM data
   | 
===&#39;
&lt;&lt;
    {
      &#39;city: ;Seattle;,
      &#39;state: &#39;WA;
    },
    {
      &#39;city: &#39;Bellevue&#39;,
      &#39;state: &#39;WA&#39;
    },
    {
      &#39;city: &#39;Honolulu&#39;,
      &#39;state: &#39;HI&#39;
    },
    {
      &#39;city: &#39;Rochester&#39;,
      &#39;state: &#39;NY&#39;
    }
&gt;&gt;
------
OK!</code></pre>
<h1 id="tsvcsv-data">TSV/CSV Data</h1>
<p>The <code>read_file</code> function supports an optional struct argument to add additional parsing options. Parsing delimited files can be specified with the <code>type</code> field with a string <code>tsv</code> or <code>csv</code> to parse tab or comma separated values respectively.</p>
<p>Create a file called <code>simple.csv</code> in the <code>cli</code> directory with the following contents</p>
<pre><code>title,category,price
harry potter,book,7.99
dot,electronics,49.99
echo,electronics,99.99</code></pre>
<pre><code>PartiQL&gt; read_file(&#39;simple.csv&#39;, {&#39;type&#39;:&#39;csv&#39;})
   | 
===&#39; 
&lt;&lt;
    {
      _0:&#39;title&#39;,
      _1:&#39;category&#39;,
      _2:&#39;price&#39;
    },
    {
      _0:&#39;harry potter&#39;,
      _1:&#39;book&#39;,
      _2:&#39;7.99&#39;
    },
    {
      _0:&#39;dot&#39;,
      _1:&#39;electronics&#39;,
      _2:&#39;49.99&#39;
    },
    {
      _0:&#39;echo&#39;,
      _1:&#39;electronics&#39;,
      _2:&#39;99.99&#39;
    }
&gt;&gt;
---- 
OK!</code></pre>
<p>The options <code>struct</code> can also define if the first row for delimited data should be the column names with the <code>header</code> field.</p>
<pre><code>PartiQL&gt; read_file(&#39;simple.csv&#39;, {&#39;type&#39;: &#39;csv&#39;, &#39;header&#39;: true})
   | 
===&#39; 
&lt;&lt;
    {
      &#39;title&#39;: &#39;harry potter&#39;,
      &#39;category&#39;: &#39;book&#39;,
      &#39;price&#39;: &#39;7.99&#39;
    },
    {
      &#39;title&#39;: &#39;dot&#39;,
      &#39;category&#39;: &#39;electronics&#39;,
      &#39;price&#39;: &#39;49.99&#39;
    },
    {
      &#39;title&#39;: &#39;echo&#39;,
      &#39;category&#39;: &#39;electronics&#39;,
      &#39;price&#39;: &#39;99.99&#39;
    }
&gt;&gt;
---- 
OK!</code></pre>
<p>Auto conversion can also be specified numeric and timestamps in delimited data.</p>
<pre><code>PartiQL&gt; read_file(&#39;simple.csv&#39;, {&#39;type&#39;:&#39;csv&#39;, &#39;header&#39;:true, &#39;conversion&#39;:&#39;auto&#39;})
   | 
===&#39; 
&lt;&lt;
    {
      &#39;title&#39;:&#39; harry potter&#39;,
      &#39;category&#39;: &#39;book&#39;,
      &#39;price&#39;: 7.99
    },
    {
      &#39;title: &#39;dot&#39;,
      &#39;category&#39;: &#39;electronics&#39;,
      &#39;price&#39;: 49.99
    },
    {
      &#39;title: &#39;echo&#39;,
      &#39;category&#39;: &#39;electronics&#39;,
      &#39;price&#39;: 99.99
    }
&gt;&gt;
---- 
OK!</code></pre>
<p>Writing TSV/CSV data can be done by specifying the optional <code>struct</code> argument to specify output format to the <code>write_file</code> function. Similar to the <code>read_file</code> function, the <code>type</code> field can be used to specify <code>tsv</code>, <code>csv</code>, or <code>ion</code> output.</p>
<pre><code>PartiQL&gt; write_file(&#39;out.tsv&#39;, SELECT name, type FROM animals, {&#39;type&#39;:&#39;tsv&#39;},)
   | 
===&#39; 
true
----
OK!</code></pre>
<p>This would produce the following file:</p>
<pre><code>$ cat out.tsv
Kumo    dog
Mochi   dog
Lilikoi unicorn</code></pre>
<p>The options <code>struct</code> can also specify a <code>header</code> Boolean field to indicate whether the output TSV/CSV should have a header row.</p>
<pre><code>PartiQL&gt; write_file(&#39;out.tsv&#39;, SELECT name, type FROM animals, {&#39;type&#39;:&#39;tsv&#39;, &#39;header&#39;:true})
   | 
===&#39; 
true
----
OK!</code></pre>
<p>Which would produce the following file:</p>
<pre><code>$ cat out.tsv
name    type
Kumo    dog
Mochi   dog
Lilikoi unicorn</code></pre>
<h2 id="predefined-csv-data">Predefined CSV Data</h2>
<p>The <code>read_file</code> function provides options to read other predefined CSV data formats. For example, if a CSV file is exported from PostgreSQL, we can use the following command to read the file:</p>
<pre><code>read_file(&#39;simple_postgresql.csv&#39;, {&#39;type&#39;:&#39;postgresql_csv&#39;})</code></pre>
<p>Other available options for the argument <code>type</code> besides <code>postgresql_csv</code> are <code>excel_csv</code>, <code>mysql_csv</code>, and <code>postgresql_text</code>.</p>
<h2 id="customized-csv-data">Customized CSV Data</h2>
<p>The <code>read_file</code> function also provides options to read customized CSV data formats. For example, we have a data file where the whitespace is the separator as shown below:</p>
<pre><code>title category price
harry_potter book 7.99
dot electronics 49.99
echo electronics 99.99</code></pre>
<p>We can use the following command to read the file:</p>
<pre><code>read_file(&#39;customized.csv&#39;, {&#39;type&#39;:&#39;customized&#39;, &#39;delimiter&#39;:&#39; &#39;, &#39;header&#39;:true})</code></pre>
<p>All the available options for customized CSV files are shown as following: 1. Ignore empty lines: <code>'ignore_empty_line':true</code> 2. Ignore spaces surrounding comma: <code>'ignore_surrounding_space':true</code> 3. Trim leading and trailing blanks: <code>'trim':true</code> 4. Set line breaker (only working with ‘\r’, ‘\n’ and ‘\r\n’): <code>'line_breaker: \n'</code> 5. Set escape sign (single character only): <code>'escape':'\'</code> 6. Set quote sign (single character only): <code>'quote':'"'</code> 7. Set delimiter sign (single character only): <code>'delimiter':','</code></p>
<h2 id="permissive-typing-mode">Permissive Typing Mode</h2>
<p>By default, the CLI/REPL runs in <a href="https://github.com/partiql/partiql-lang-kotlin/blob/main/lang/src/org/partiql/lang/eval/CompileOptions.kt#L53-L62">LEGACY</a> typing mode, which will give an evaluation time error in the case of data type mismatches.</p>
<pre><code>(Running in the default LEGACY typing mode)
PartiQL&gt; 1 + &#39;foo&#39;;
org.partiql.lang.eval.EvaluationException: ...
    ...</code></pre>
<p>Specifying the <code>-p</code> or <code>-permissive</code> flag will allow you to run PartiQL queries in <a href="https://github.com/partiql/partiql-lang-kotlin/blob/main/lang/src/org/partiql/lang/eval/CompileOptions.kt#L64-L73">PERMISSIVE</a> typing mode, which will return <code>MISSING</code> in the case of data type mismatches.</p>
<pre><code>(Running in PERMISSIVE typing mode)
PartiQL&gt; 1 + &#39;foo&#39;;
===&#39;
MISSING
---
OK!</code></pre>
<h1 id="partiql-tutorial">PartiQL Tutorial</h1>
<p>TBD</p>
<h1 id="partiql-user-guide">PartiQL User Guide</h1>
<h2 id="introduction">Introduction</h2>
<p>This is the PartiQL implementation’s user guide. The goal of this document is to provide to users of PartiQL information on the features implemented and any deviation from the PartiQL specification.</p>
<h2 id="data-types">Data Types</h2>
<h3 id="decimal">Decimal</h3>
<p>PartiQL decimals are based on <a href="http://amzn.github.io/ion-docs/decimal.html">Ion decimals</a> from the Ion Specification<span class="citation" data-cites="IonSpec">[<a href="#ref-IonSpec" role="doc-biblioref">1</a>]</span> but with a maximum precision of 38 digits, numbers outside this precision range will be rounded using a round <a href="https://docs.oracle.com/javase/7/docs/api/java/math/RoundingMode.html#HALF_EVEN/">half even strategy</a>. Examples:</p>
<pre><code>1.00000000000000000000000000000000000000000001 -&gt; 1.0000000000000000000000000000000000000
1.99999999999999999999999999999999999999999999 -&gt; 2.0000000000000000000000000000000000000 </code></pre>
<h2 id="built-in-functions">Built-in Functions</h2>
<p>This section provides documentation for all built-in functions available with the reference implementation. For each function the documentation provides</p>
<ol type="1">
<li>A one sentence explanation of the functions intent.</li>
<li>The function’s <strong>signature</strong> that specifies data types and names for each input argument, and, the expected data type for the function’s return value. A function signature consists of the function’s name followed by a colon <code>:</code> then a space separated list of data types–one for each formal argument of the function–followed by an arrow <code>-&gt;</code> followed by the function’s return type, e.g., <code>add: Integer Integer -&gt; Integer</code> is the signature for <code>add</code> which accepts 2 inputs both <code>Integer</code>’s and returns one value of type <code>Integer</code>.</li>
<li>The function’s <strong>header</strong> that specifies names for each of the function’s formal arguments. Any documentation following the header can refer to the function’s formal arguments by name.</li>
<li>The function’s <strong>purpose statement</strong> that further expands on how the function behaves and specifies any pre- and/or post-conditions.</li>
<li>A list of examples calling the function and their expected results.</li>
</ol>
<h3 id="unknown-null-and-missing-propagation">Unknown (<code>null</code> and <code>missing</code>) propagation</h3>
<p>Unless otherwise stated all functions listed below propagate <code>null</code> and <code>missing</code> argument values. Propagating <code>null</code> and <code>missing</code> values is defined as: if any function argument is either <code>null</code> or <code>missing</code> the function will return <code>null</code>, e.g.,</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true"></a>CHAR_LENGTH(<span class="kw">null</span>)    <span class="co">-- `null`</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true"></a>CHAR_LENGTH(missing) <span class="co">-- `null` (also returns `null`)</span></span></code></pre></div>
<h3 id="cast">CAST</h3>
<p>Given a value and a target data type, attempt to coerce the value to the target data type.</p>
<dl>
<dt>Signature</dt>
<dd><code>CAST: Any DataType -&gt; DataType</code>
</dd>
</dl>
<p>Where <code>DataType</code> is one of</p>
<ul>
<li><code>missing</code></li>
<li><code>null</code></li>
<li><code>integer</code></li>
<li><code>boolean</code></li>
<li><code>float</code></li>
<li><code>decimal</code></li>
<li><code>timestamp</code></li>
<li><code>symbol</code></li>
<li><code>string</code></li>
<li><code>list</code></li>
<li><code>struct</code></li>
<li><code>bag</code></li>
</ul>
<dl>
<dt>Header</dt>
<dd><code>CAST(exp AS dt)</code>
</dd>
<dt>Purpose</dt>
<dd>Given an expression, <code>exp</code> and the data type name, <code>dt</code>, evaluate <code>expr</code> to a value, <code>v</code> and alter the data type of <code>v</code> to <code>DT(dt)</code>. If the conversion cannot be made the implementation signals an error.
</dd>
</dl>
<p>The runtime support for casts is</p>
<ul>
<li>Casting to <code>null</code> from
<ul>
<li><code>null</code> is a no-op</li>
<li><code>missing</code> returns <code>null</code></li>
<li>else error</li>
</ul></li>
<li>Casting to <code>missing</code> from
<ul>
<li><code>missing</code> is a no-op</li>
<li><code>null</code> returns <code>missing</code></li>
<li>else error</li>
</ul></li>
<li>Casting to <code>integer</code> from
<ul>
<li>Integer: is a no-op</li>
<li>Boolean: <code>true</code> returns 1, <code>false</code> returns 0</li>
<li>String or Symbol: attempt to parse the content as an Integer and return the Integer, else error.</li>
<li>Float or Decimal: gets narrowed to Integer</li>
<li>else error</li>
</ul></li>
<li>Casting to <code>boolean</code> from
<ul>
<li>Boolean is a no-op</li>
<li>Integer or Decimal or Float: if <code>v</code> is a representation of the number <code>0</code> (e.g., <code>0</code> or <code>-0</code> or <code>0e0</code> or <code>0d0</code> et.) then <code>false</code> else <code>true</code></li>
<li>String or Symbol: <code>true</code> unless <code>v</code> matches–ignoring character case–the Ion string <code>"false"</code> or matches–ignoring character case– the Ion symbol <code>'false'</code> then return <code>false</code></li>
<li>else error</li>
</ul></li>
<li>Casting to <code>float</code> from
<ul>
<li>Float is a no-op</li>
<li>Boolean: <code>false</code> return <code>0.0</code>, <code>true</code> returns <code>1.0</code></li>
<li>Integer or Decimal: convert to Float and return</li>
<li>String or Symbol: attempt to parse as Float and return the Float value, else error</li>
<li>else error</li>
</ul></li>
<li>Casting to <code>decimal</code> from
<ul>
<li>Decimal is a no-op</li>
<li>Boolean: return <code>1d0</code> if <code>true</code>, <code>0d0</code> if <code>false</code></li>
<li>String or Symbol: attemp to parse as Decimal and return Decimal value, else error</li>
<li>else error</li>
</ul></li>
<li>Casting to <code>timestamp</code> from
<ul>
<li>Timestamp is a no-op</li>
<li>String or Symbol: attemp to parse as Timestamp and return the Timestamp value, else error</li>
<li>else error</li>
</ul></li>
<li>Casting to <code>symbol</code> from
<ul>
<li>Symbol is a no-op</li>
<li>Integer or Float or Decimal: narrow to Integer and return the value as a Symbol, i.e, a Symbol with the same sequence of digits as characters</li>
<li>String: return the String as a Symbol, i.e., represent the same sequence of characters as a Symbol</li>
<li>Boolean: return <code>'true'</code> for <code>true</code> and <code>'false'</code> for <code>false</code></li>
<li>Timestamp: return the Symbol representation of the Timestamp, i.e., represent the same sequence of digits and characters as a Symbol</li>
<li>else error</li>
</ul></li>
<li>Casting to <code>string</code> from
<ul>
<li>String is a no-op</li>
<li>Integer or Float or Decimal: narrow to Integer and return the value as a String, i.e, a String with the same sequence of digits as characters</li>
<li>Symbol: return the String as a Symbol, i.e., represent the same sequence of characters as a String</li>
<li>Boolean: return <code>"true"</code> for <code>true</code> and <code>"false"</code> for <code>false</code></li>
<li>Timestamp: return the String representation of the Timestamp, i.e., represent the same sequence of digits and characters as a String</li>
<li>else error</li>
</ul></li>
<li>Casting to <code>list</code> from
<ul>
<li>List is a no-op</li>
<li>Bag: return a list with the same elements. The order of the elements in the resulting list is unspecified.</li>
<li>else error</li>
</ul></li>
<li>Casting to <code>struct</code> from
<ul>
<li>Struct is a no-op</li>
<li>else error</li>
</ul></li>
<li>Casting to <code>bag</code> from
<ul>
<li>Bag is a no-op</li>
<li>List: return a list with the same elements. The order of the elements in the resulting bag is unspecified.</li>
</ul></li>
</ul>
<p>Examples :</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true"></a><span class="co">-- Unknowns propagation </span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="kw">null</span>    <span class="kw">AS</span> <span class="kw">null</span>)    <span class="co">-- null </span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true"></a><span class="fu">CAST</span>(missing <span class="kw">AS</span> <span class="kw">null</span>)    <span class="co">-- null </span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true"></a><span class="fu">CAST</span>(missing <span class="kw">AS</span> missing) <span class="co">-- null</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="kw">null</span>    <span class="kw">AS</span> missing) <span class="co">-- null</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="kw">null</span>    <span class="kw">AS</span> <span class="dt">boolean</span>) <span class="co">-- null (null AS any data type name result to null)</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true"></a><span class="fu">CAST</span>(missing <span class="kw">AS</span> <span class="dt">boolean</span>) <span class="co">-- null (missing AS any data type name result to null)</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true"></a><span class="co">-- any value that is not an unknown cannot be cast to `null` or `missing`</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="kw">true</span> <span class="kw">AS</span> <span class="kw">null</span>)    <span class="co">-- error </span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="kw">true</span> <span class="kw">AS</span> missing) <span class="co">-- error</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="dv">1</span>    <span class="kw">AS</span> <span class="kw">null</span>)    <span class="co">-- error</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="dv">1</span>    <span class="kw">AS</span> missing) <span class="co">-- error</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true"></a></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true"></a><span class="co">-- AS boolean </span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="kw">true</span>      <span class="kw">AS</span> <span class="dt">boolean</span>) <span class="co">-- true no-op</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="dv">0</span>         <span class="kw">AS</span> <span class="dt">boolean</span>) <span class="co">-- false</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="dv">1</span>         <span class="kw">AS</span> <span class="dt">boolean</span>) <span class="co">-- true</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true"></a><span class="fu">CAST</span>(`<span class="fl">1e0</span>`     <span class="kw">AS</span> <span class="dt">boolean</span>) <span class="co">-- true (float)</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true"></a><span class="fu">CAST</span>(`1d0`     <span class="kw">AS</span> <span class="dt">boolean</span>) <span class="co">-- true (decimal)</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="st">&#39;a&#39;</span>       <span class="kw">AS</span> <span class="dt">boolean</span>) <span class="co">-- false</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="st">&#39;true&#39;</span>    <span class="kw">AS</span> <span class="dt">boolean</span>) <span class="co">-- true (PartiQL string &#39;true&#39;)</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true"></a><span class="fu">CAST</span>(`<span class="st">&#39;true&#39;</span>`  <span class="kw">AS</span> <span class="dt">boolean</span>) <span class="co">-- true (Ion symbol `&#39;true&#39;`)</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true"></a><span class="fu">CAST</span>(`<span class="st">&#39;false&#39;</span>` <span class="kw">AS</span> <span class="dt">boolean</span>) <span class="co">-- false (Ion symbol `&#39;false&#39;`)</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true"></a></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true"></a><span class="co">-- AS integer</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="kw">true</span>   <span class="kw">AS</span> <span class="dt">integer</span>) <span class="co">-- 1</span></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="kw">false</span>  <span class="kw">AS</span> <span class="dt">integer</span>) <span class="co">-- 0</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="dv">1</span>      <span class="kw">AS</span> <span class="dt">integer</span>) <span class="co">-- 1</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true"></a><span class="fu">CAST</span>(`1d0`  <span class="kw">AS</span> <span class="dt">integer</span>) <span class="co">-- 1</span></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true"></a><span class="fu">CAST</span>(`1d3`  <span class="kw">AS</span> <span class="dt">integer</span>) <span class="co">-- 1000</span></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="fl">1.00</span>   <span class="kw">AS</span> <span class="dt">integer</span>) <span class="co">-- 1</span></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="st">&#39;12&#39;</span>   <span class="kw">AS</span> <span class="dt">integer</span>) <span class="co">-- 12</span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="st">&#39;aa&#39;</span>   <span class="kw">AS</span> <span class="dt">integer</span>) <span class="co">-- error</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true"></a><span class="fu">CAST</span>(`<span class="st">&#39;22&#39;</span>` <span class="kw">AS</span> <span class="dt">integer</span>) <span class="co">-- 22</span></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true"></a><span class="fu">CAST</span>(`<span class="st">&#39;x&#39;</span>`  <span class="kw">AS</span> <span class="dt">integer</span>) <span class="co">-- error</span></span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true"></a></span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true"></a><span class="co">-- AS flaot</span></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="kw">true</span>   <span class="kw">AS</span> <span class="dt">float</span>) <span class="co">-- 1e0</span></span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="kw">false</span>  <span class="kw">AS</span> <span class="dt">float</span>) <span class="co">-- 0e0</span></span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="dv">1</span>      <span class="kw">AS</span> <span class="dt">float</span>) <span class="co">-- 1e0</span></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true"></a><span class="fu">CAST</span>(`1d0`  <span class="kw">AS</span> <span class="dt">float</span>) <span class="co">-- 1e0</span></span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true"></a><span class="fu">CAST</span>(`1d3`  <span class="kw">AS</span> <span class="dt">float</span>) <span class="co">-- 1000e0</span></span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="fl">1.00</span>   <span class="kw">AS</span> <span class="dt">float</span>) <span class="co">-- 1e0</span></span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="st">&#39;12&#39;</span>   <span class="kw">AS</span> <span class="dt">float</span>) <span class="co">-- 12e0</span></span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="st">&#39;aa&#39;</span>   <span class="kw">AS</span> <span class="dt">float</span>) <span class="co">-- error</span></span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true"></a><span class="fu">CAST</span>(`<span class="st">&#39;22&#39;</span>` <span class="kw">AS</span> <span class="dt">float</span>) <span class="co">-- 22e0</span></span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true"></a><span class="fu">CAST</span>(`<span class="st">&#39;x&#39;</span>`  <span class="kw">AS</span> <span class="dt">float</span>) <span class="co">-- error</span></span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true"></a></span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true"></a><span class="co">-- AS decimal</span></span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="kw">true</span>   <span class="kw">AS</span> <span class="dt">decimal</span>) <span class="co">-- 1.</span></span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="kw">false</span>  <span class="kw">AS</span> <span class="dt">decimal</span>) <span class="co">-- 0.</span></span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="dv">1</span>      <span class="kw">AS</span> <span class="dt">decimal</span>) <span class="co">-- 1.</span></span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true"></a><span class="fu">CAST</span>(`1d0`  <span class="kw">AS</span> <span class="dt">decimal</span>) <span class="co">-- 1. (REPL printer serialized to 1.)</span></span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true"></a><span class="fu">CAST</span>(`1d3`  <span class="kw">AS</span> <span class="dt">decimal</span>) <span class="co">-- 1d3</span></span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="fl">1.00</span>   <span class="kw">AS</span> <span class="dt">decimal</span>) <span class="co">-- 1.00</span></span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="st">&#39;12&#39;</span>   <span class="kw">AS</span> <span class="dt">decimal</span>) <span class="co">-- 12.</span></span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="st">&#39;aa&#39;</span>   <span class="kw">AS</span> <span class="dt">decimal</span>) <span class="co">-- error</span></span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true"></a><span class="fu">CAST</span>(`<span class="st">&#39;22&#39;</span>` <span class="kw">AS</span> <span class="dt">decimal</span>) <span class="co">-- 22.</span></span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true"></a><span class="fu">CAST</span>(`<span class="st">&#39;x&#39;</span>`  <span class="kw">AS</span> <span class="dt">decimal</span>) <span class="co">-- error</span></span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true"></a></span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true"></a><span class="co">-- AS timestamp</span></span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true"></a><span class="fu">CAST</span>(`2001T`                      <span class="kw">AS</span> <span class="dt">timestamp</span>) <span class="co">-- 2001T</span></span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="st">&#39;2001-01-01T&#39;</span>                <span class="kw">AS</span> <span class="dt">timestamp</span>) <span class="co">-- 2001-01-01</span></span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true"></a><span class="fu">CAST</span>(`<span class="st">&#39;2010-01-01T00:00:00.000Z&#39;</span>` <span class="kw">AS</span> <span class="dt">timestamp</span>) <span class="co">-- 2010-01-01T00:00:00.000Z</span></span>
<span id="cb48-66"><a href="#cb48-66" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="kw">true</span>                         <span class="kw">AS</span> <span class="dt">timestamp</span>) <span class="co">-- error</span></span>
<span id="cb48-67"><a href="#cb48-67" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="dv">2001</span>                         <span class="kw">AS</span> <span class="dt">timestamp</span>) <span class="co">-- error</span></span>
<span id="cb48-68"><a href="#cb48-68" aria-hidden="true"></a></span>
<span id="cb48-69"><a href="#cb48-69" aria-hidden="true"></a><span class="co">-- AS symbol </span></span>
<span id="cb48-70"><a href="#cb48-70" aria-hidden="true"></a><span class="fu">CAST</span>(`<span class="st">&#39;xx&#39;</span>`                     <span class="kw">AS</span> symbol) <span class="co">-- xx (`&#39;xx&#39;` is an Ion symbol)</span></span>
<span id="cb48-71"><a href="#cb48-71" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="st">&#39;xx&#39;</span>                       <span class="kw">AS</span> symbol) <span class="co">-- xx (&#39;xx&#39; is a string)</span></span>
<span id="cb48-72"><a href="#cb48-72" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="dv">42</span>                         <span class="kw">AS</span> symbol) <span class="co">-- &#39;42&#39;</span></span>
<span id="cb48-73"><a href="#cb48-73" aria-hidden="true"></a><span class="fu">CAST</span>(`<span class="fl">1e0</span>`                      <span class="kw">AS</span> symbol) <span class="co">-- &#39;1&#39;</span></span>
<span id="cb48-74"><a href="#cb48-74" aria-hidden="true"></a><span class="fu">CAST</span>(`1d0`                      <span class="kw">AS</span> symbol) <span class="co">-- &#39;1&#39;</span></span>
<span id="cb48-75"><a href="#cb48-75" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="kw">true</span>                       <span class="kw">AS</span> symbol) <span class="co">-- &#39;true&#39;</span></span>
<span id="cb48-76"><a href="#cb48-76" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="kw">false</span>                      <span class="kw">AS</span> symbol) <span class="co">-- &#39;false&#39;</span></span>
<span id="cb48-77"><a href="#cb48-77" aria-hidden="true"></a><span class="fu">CAST</span>(`2001T`                    <span class="kw">AS</span> symbol) <span class="co">-- &#39;2001T&#39;</span></span>
<span id="cb48-78"><a href="#cb48-78" aria-hidden="true"></a><span class="fu">CAST</span>(`<span class="dv">2001</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>01T00<span class="ch">:00:00</span><span class="fl">.000</span>Z` <span class="kw">AS</span> symbol) <span class="co">-- &#39;2001-01-01T00:00:00.000Z`</span></span>
<span id="cb48-79"><a href="#cb48-79" aria-hidden="true"></a></span>
<span id="cb48-80"><a href="#cb48-80" aria-hidden="true"></a><span class="co">-- AS string </span></span>
<span id="cb48-81"><a href="#cb48-81" aria-hidden="true"></a><span class="fu">CAST</span>(`<span class="st">&#39;xx&#39;</span>`                     <span class="kw">AS</span> string) <span class="co">-- &quot;xx&quot; (`&#39;xx&#39;` is an Ion symbol)</span></span>
<span id="cb48-82"><a href="#cb48-82" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="st">&#39;xx&#39;</span>                       <span class="kw">AS</span> string) <span class="co">-- &quot;xx&quot; (&#39;xx&#39; is a string)</span></span>
<span id="cb48-83"><a href="#cb48-83" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="dv">42</span>                         <span class="kw">AS</span> string) <span class="co">-- &quot;42&quot;</span></span>
<span id="cb48-84"><a href="#cb48-84" aria-hidden="true"></a><span class="fu">CAST</span>(`<span class="fl">1e0</span>`                      <span class="kw">AS</span> string) <span class="co">-- &quot;1.0&quot;</span></span>
<span id="cb48-85"><a href="#cb48-85" aria-hidden="true"></a><span class="fu">CAST</span>(`1d0`                      <span class="kw">AS</span> string) <span class="co">-- &quot;1&quot;</span></span>
<span id="cb48-86"><a href="#cb48-86" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="kw">true</span>                       <span class="kw">AS</span> string) <span class="co">-- &quot;true&quot;</span></span>
<span id="cb48-87"><a href="#cb48-87" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="kw">false</span>                      <span class="kw">AS</span> string) <span class="co">-- &quot;false&quot;</span></span>
<span id="cb48-88"><a href="#cb48-88" aria-hidden="true"></a><span class="fu">CAST</span>(`2001T`                    <span class="kw">AS</span> string) <span class="co">-- &quot;2001T&quot;</span></span>
<span id="cb48-89"><a href="#cb48-89" aria-hidden="true"></a><span class="fu">CAST</span>(`<span class="dv">2001</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>01T00<span class="ch">:00:00</span><span class="fl">.000</span>Z` <span class="kw">AS</span> string) <span class="co">-- &quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span id="cb48-90"><a href="#cb48-90" aria-hidden="true"></a></span>
<span id="cb48-91"><a href="#cb48-91" aria-hidden="true"></a><span class="co">-- AS struct </span></span>
<span id="cb48-92"><a href="#cb48-92" aria-hidden="true"></a><span class="fu">CAST</span>(`{ a: <span class="dv">1</span> }` <span class="kw">AS</span> struct) <span class="co">-- { a:1 }</span></span>
<span id="cb48-93"><a href="#cb48-93" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="kw">true</span>       <span class="kw">AS</span> struct) <span class="co">-- err</span></span>
<span id="cb48-94"><a href="#cb48-94" aria-hidden="true"></a></span>
<span id="cb48-95"><a href="#cb48-95" aria-hidden="true"></a><span class="co">-- AS list</span></span>
<span id="cb48-96"><a href="#cb48-96" aria-hidden="true"></a><span class="fu">CAST</span>(`[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]`        <span class="kw">AS</span> <span class="kw">list</span>) <span class="co">-- [ 1, 2, 3 ] (REPL does not diplay the parens and commas)</span></span>
<span id="cb48-97"><a href="#cb48-97" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="op">&lt;&lt;</span><span class="st">&#39;a&#39;</span>, { <span class="st">&#39;b&#39;</span><span class="ch">:2</span> }<span class="op">&gt;&gt;</span> <span class="kw">AS</span> <span class="kw">list</span>) <span class="co">-- [ a, { &#39;b&#39;:2 } ] (REPL does not diplay the parens and commas)</span></span>
<span id="cb48-98"><a href="#cb48-98" aria-hidden="true"></a><span class="fu">CAST</span>({ <span class="st">&#39;b&#39;</span><span class="ch">:2</span> }          <span class="kw">AS</span> <span class="kw">list</span>) <span class="co">-- error</span></span>
<span id="cb48-99"><a href="#cb48-99" aria-hidden="true"></a></span>
<span id="cb48-100"><a href="#cb48-100" aria-hidden="true"></a><span class="co">-- AS bag</span></span>
<span id="cb48-101"><a href="#cb48-101" aria-hidden="true"></a><span class="fu">CAST</span>([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]      <span class="kw">AS</span> bag) <span class="co">-- &lt;&lt;1,2,3&gt;&gt; (REPL does not display &lt;&lt; &gt;&gt; and commas)</span></span>
<span id="cb48-102"><a href="#cb48-102" aria-hidden="true"></a><span class="fu">CAST</span>([<span class="dv">1</span>,[<span class="dv">2</span>],<span class="dv">3</span>]    <span class="kw">AS</span> bag) <span class="co">-- &lt;&lt;1,[2],3&gt;&gt; (REPL does not display &lt;&lt; &gt;&gt; and commas)</span></span>
<span id="cb48-103"><a href="#cb48-103" aria-hidden="true"></a><span class="fu">CAST</span>(<span class="op">&lt;&lt;</span><span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span><span class="op">&gt;&gt;</span> <span class="kw">AS</span> bag) <span class="co">-- &lt;&lt;&#39;a&#39;, &#39;b&#39;&gt;&gt; (REPL does not display &lt;&lt; &gt;&gt; and commas)</span></span></code></pre></div>
<h3 id="char_length-character_length">CHAR_LENGTH, CHARACTER_LENGTH</h3>
<p>Counts the number of characters in the specified string, where ‘character’ is defined as a single unicode code point.</p>
<p><em>Note:</em> <code>CHAR_LENGTH</code> and <code>CHARACTER_LENGTH</code> are synonyms.</p>
<dl>
<dt>Signature</dt>
<dd><code>CHAR_LENGTH: String -&gt; Integer</code>
</dd>
</dl>
<p><code>CHARACTER_LENGTH: String -&gt; Integer</code></p>
<dl>
<dt>Header</dt>
<dd><code>CHAR_LENGTH(str)</code>
</dd>
</dl>
<p><code>CHARACTER_LENGTH(str)</code></p>
<dl>
<dt>Purpose</dt>
<dd>Given a <code>String</code> value <code>str</code> return the number of characters (code points) in <code>str</code>.
</dd>
<dt>Examples</dt>
<dd>
</dd>
</dl>
<div class="sourceCode" id="cb49"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true"></a>CHAR_LENGTH(<span class="st">&#39;&#39;</span>)          <span class="co">-- 0</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true"></a>CHAR_LENGTH(<span class="st">&#39;abcdefg&#39;</span>)   <span class="co">-- 7</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true"></a>CHAR_LENGTH(<span class="st">&#39;😁😞😸😸&#39;</span>) <span class="co">-- 4 (non-BMP unicode characters)</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true"></a>CHAR_LENGTH(<span class="st">&#39;eࠫ&#39;</span>)         <span class="co">-- 2 (because &#39;eࠫ&#39; is two codepoints: the letter &#39;e&#39; and combining character U+032B)</span></span></code></pre></div>
<h3 id="coalesce">COALESCE</h3>
<p>Evaluates the arguments in order and returns the first non unknown, i.e. first non-<code>null</code> or non-<code>missing</code>. This function does <strong>not</strong> propagate <code>null</code> and <code>missing</code>.</p>
<dl>
<dt>Signature</dt>
<dd><code>COALESCE: Any Any ... -&gt; Any</code>
</dd>
<dt>Header</dt>
<dd><code>COALESCE(exp, [exp ...])</code>
</dd>
<dt>Purpose</dt>
<dd>Given a list of 1 or more arguments, evaluates the arguments left-to-right and returns the first value that is <strong>not</strong> an unknown (<code>missing</code> or <code>null</code>).
</dd>
<dt>Examples</dt>
<dd>
</dd>
</dl>
<div class="sourceCode" id="cb50"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true"></a><span class="fu">COALESCE</span>(<span class="dv">1</span>)                <span class="co">-- 1</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true"></a><span class="fu">COALESCE</span>(<span class="kw">null</span>)             <span class="co">-- null</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true"></a><span class="fu">COALESCE</span>(<span class="kw">null</span>, <span class="kw">null</span>)       <span class="co">-- null</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true"></a><span class="fu">COALESCE</span>(missing)          <span class="co">-- null</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true"></a><span class="fu">COALESCE</span>(missing, missing) <span class="co">-- null</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true"></a><span class="fu">COALESCE</span>(<span class="dv">1</span>, <span class="kw">null</span>)          <span class="co">-- 1</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true"></a><span class="fu">COALESCE</span>(<span class="kw">null</span>, <span class="kw">null</span>, <span class="dv">1</span>)    <span class="co">-- 1</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true"></a><span class="fu">COALESCE</span>(<span class="kw">null</span>, <span class="st">&#39;string&#39;</span>)   <span class="co">-- &#39;string&#39;</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true"></a><span class="fu">COALESCE</span>(missing, <span class="dv">1</span>)       <span class="co">-- 1</span></span></code></pre></div>
<h3 id="date_add">DATE_ADD</h3>
<p>Given a data part, a quantity and a timestamp, returns an updated timestamp by altering datetime part by quantity</p>
<dl>
<dt>Signature</dt>
<dd><code>DATE_ADD: DateTimePart Integer Timestamp -&gt; Timestamp</code>
</dd>
</dl>
<p>Where <code>DateTimePart</code> is one of</p>
<ul>
<li><code>year</code></li>
<li><code>month</code></li>
<li><code>day</code></li>
<li><code>hour</code></li>
<li><code>minute</code></li>
<li><code>second</code></li>
</ul>
<dl>
<dt>Header</dt>
<dd><code>DATE_ADD(dp, q, timestamp)</code>
</dd>
<dt>Purpose</dt>
<dd>Given a data part <code>dp</code>, a quantity <code>q</code>, and, an Ion timestamp <code>timestamp</code> returns an updated timestamp by applying the value for <code>q</code> to the <code>dp</code> component of <code>timestamp</code>. Positive values for <code>q</code> add to the <code>timestamp</code>’s <code>dp</code>, negative values subtract.
</dd>
</dl>
<p>The value for <code>timestamp</code> as well as the return value from <code>DATE_ADD</code> must be a valid <a href="https://amzn.github.io/ion-docs/spec.html#timestamp">Ion Timestamp</a></p>
<dl>
<dt>Examples</dt>
<dd>
</dd>
</dl>
<div class="sourceCode" id="cb51"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true"></a>DATE_ADD(<span class="dt">year</span>, <span class="dv">5</span>, `<span class="dv">2010</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>01T`)                <span class="co">-- 2015-01-01 (equivalent to 2015-01-01T)</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true"></a>DATE_ADD(<span class="dt">month</span>, <span class="dv">1</span>, `2010T`)                     <span class="co">-- 2010-02T (result will add precision as necessary)</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true"></a>DATE_ADD(<span class="dt">month</span>, <span class="dv">13</span>, `2010T`)                    <span class="co">-- 2011-02T</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true"></a>DATE_ADD(<span class="dt">day</span>, <span class="op">-</span><span class="dv">1</span>, `<span class="dv">2017</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>10T`)                <span class="co">-- 2017-01-09 (equivalent to 2017-01-09T)</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true"></a>DATE_ADD(<span class="kw">hour</span>, <span class="dv">1</span>, `2017T`)                      <span class="co">-- 2017-01-01T01:00-00:00</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true"></a>DATE_ADD(<span class="kw">hour</span>, <span class="dv">1</span>, `<span class="dv">2017</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>02T03<span class="ch">:04Z</span>`)          <span class="co">-- 2017-01-02T04:04Z</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true"></a>DATE_ADD(<span class="kw">minute</span>, <span class="dv">1</span>, `<span class="dv">2017</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>02T03<span class="ch">:04:05</span><span class="fl">.006</span>Z`) <span class="co">-- 2017-01-02T03:05:05.006Z</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true"></a>DATE_ADD(<span class="dt">second</span>, <span class="dv">1</span>, `<span class="dv">2017</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>02T03<span class="ch">:04:05</span><span class="fl">.006</span>Z`) <span class="co">-- 2017-01-02T03:04:06.006Z</span></span></code></pre></div>
<h3 id="date_diff">DATE_DIFF</h3>
<p>Given a datetime part and two valid timestamps returns the difference in datetime parts.</p>
<dl>
<dt>Signature</dt>
<dd><code>DATE_DIFF: DateTimePart Timestamp Timestamp -&gt; Integer</code>
</dd>
</dl>
<p>See <a href="#date_add">DATE_ADD</a> for the definition of <code>DateTimePart</code></p>
<dl>
<dt>Header</dt>
<dd><code>DATE_DIFF(dp, t1, t2)</code>
</dd>
<dt>Purpose</dt>
<dd>Given a datetime part <code>dp</code> and two timestamps <code>t1</code> and <code>t2</code> returns the difference in value for <code>dp</code> part of <code>t1</code> with <code>t2</code>. The return value is a negative integer when the <code>dp</code> value of <code>t1</code> is greater than the <code>dp</code> value of <code>t2</code>, and, a positive integer when the <code>dp</code> value of <code>t1</code> is less than the <code>dp</code> value of <code>t2</code>.
</dd>
<dt>Examples</dt>
<dd>
</dd>
</dl>
<div class="sourceCode" id="cb52"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true"></a>DATE_DIFF(<span class="dt">year</span>, `<span class="dv">2010</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>01T`, `<span class="dv">2011</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>01T`)            <span class="co">-- 1</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true"></a>DATE_DIFF(<span class="dt">year</span>, `2010T`, `<span class="dv">2010</span><span class="op">-</span>05T`)                     <span class="co">-- 4 (2010T is equivalent to 2010-01-01T00:00:00.000Z)</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true"></a>DATE_DIFF(<span class="dt">month</span>, `2010T`, `2011T`)                       <span class="co">-- 12</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true"></a>DATE_DIFF(<span class="dt">month</span>, `2011T`, `2010T`)                       <span class="co">-- -12</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true"></a>DATE_DIFF(<span class="dt">day</span>, `<span class="dv">2010</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>01T23<span class="ch">:00T</span>`, `<span class="dv">2010</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>02T01<span class="ch">:00T</span>`) <span class="co">-- 0 (need to be at least 24h apart to be 1 day apart)</span></span></code></pre></div>
<h3 id="exists">EXISTS</h3>
<p>Given a PartiQL value returns <code>true</code> if and only if the value is a non-empty container(bag, sexp, list or struct), returns <code>false</code> otherwise.</p>
<dl>
<dt>Signature</dt>
<dd><code>EXISTS: Container -&gt; Boolean</code>
</dd>
<dt>Header</dt>
<dd><code>EXISTS(val)</code>
</dd>
<dt>Purpose</dt>
<dd>Given a PartiQL value <code>val</code>, if <code>val</code> is<br />
1. a container with size &gt; 0, <code>EXISTS(val)</code> returns <code>true</code>; 2. a container with size = 0, <code>EXISTS(val)</code> returns <code>false</code>; 3. not a container, <code>EXISTS(val)</code> throws an error.
</dd>
</dl>
<p>Note: 1. This function does <strong>not</strong> propagate <code>null</code> and <code>missing</code>.</p>
<dl>
<dt>Examples</dt>
<dd>
</dd>
</dl>
<div class="sourceCode" id="cb53"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true"></a><span class="kw">EXISTS</span>(`[]`)        <span class="co">-- false (empty list)</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true"></a><span class="kw">EXISTS</span>(`[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]`) <span class="co">-- true (non-empty list)</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true"></a><span class="kw">EXISTS</span>(`[missing]`) <span class="co">-- true (non-empty list)</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true"></a><span class="kw">EXISTS</span>(`{}`)        <span class="co">-- false (empty struct)</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true"></a><span class="kw">EXISTS</span>(`{ a: <span class="dv">1</span> }`)  <span class="co">-- true (non-empty struct)</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true"></a><span class="kw">EXISTS</span>(`()`)        <span class="co">-- false (empty s-expression)</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true"></a><span class="kw">EXISTS</span>(`(<span class="op">+</span> <span class="dv">1</span> <span class="dv">2</span>)`)   <span class="co">-- true (non-empty s-expression)</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true"></a><span class="kw">EXISTS</span>(`<span class="op">&lt;&lt;&gt;&gt;</span>`)      <span class="co">-- false (empty bag)</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true"></a><span class="kw">EXISTS</span>(`<span class="op">&lt;&lt;</span><span class="kw">null</span><span class="op">&gt;&gt;</span>`)  <span class="co">-- true (non-empty bag)</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true"></a><span class="kw">EXISTS</span>(<span class="dv">1</span>)           <span class="co">-- error</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true"></a><span class="kw">EXISTS</span>(`2017T`)     <span class="co">-- error</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true"></a><span class="kw">EXISTS</span>(<span class="kw">null</span>)        <span class="co">-- error</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true"></a><span class="kw">EXISTS</span>(missing)     <span class="co">-- error</span></span></code></pre></div>
<h3 id="extract">EXTRACT</h3>
<p>Given a datetime part and a datetime type returns then datetime’s datetime part value.</p>
<dl>
<dt>Signature</dt>
<dd><code>EXTRACT: ExtractDateTimePart DateTime -&gt; Integer</code>
</dd>
</dl>
<p>where <code>ExtractDateTimePart</code> is one of</p>
<ul>
<li><code>year</code></li>
<li><code>month</code></li>
<li><code>day</code></li>
<li><code>hour</code></li>
<li><code>minute</code></li>
<li><code>second</code></li>
<li><code>timezone_hour</code></li>
<li><code>timezone_minute</code></li>
</ul>
<p>and <code>DateTime</code> type is one of</p>
<ul>
<li><code>DATE</code></li>
<li><code>TIME</code></li>
<li><code>TIMESTAMP</code></li>
</ul>
<p><em>Note</em> that <code>ExtractDateTimePart</code> <strong>differs</strong> from <code>DateTimePart</code> in <a href="#date_add">DATE_ADD</a>.</p>
<dl>
<dt>Header</dt>
<dd><code>EXTRACT(edp FROM t)</code>
</dd>
<dt>Purpose</dt>
<dd>Given a datetime part, <code>edp</code>, and a datetime type <code>t</code> return <code>t</code>’s value for <code>edp</code>. This function allows for <code>t</code> to be unknown (<code>null</code> or <code>missing</code>) but <strong>not</strong> <code>edp</code>. If <code>t</code> is unknown the function returns <code>null</code>.
</dd>
<dt>Examples</dt>
<dd>
</dd>
</dl>
<div class="sourceCode" id="cb54"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true"></a><span class="fu">EXTRACT</span>(<span class="dt">YEAR</span> <span class="kw">FROM</span> `<span class="dv">2010</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>01T`)                           <span class="co">-- 2010</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true"></a><span class="fu">EXTRACT</span>(<span class="dt">MONTH</span> <span class="kw">FROM</span> `2010T`)                                <span class="co">-- 1 (equivalent to 2010-01-01T00:00:00.000Z)</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true"></a><span class="fu">EXTRACT</span>(<span class="dt">MONTH</span> <span class="kw">FROM</span> `<span class="dv">2010</span><span class="op">-</span>10T`)                             <span class="co">-- 10</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true"></a><span class="fu">EXTRACT</span>(<span class="kw">HOUR</span> <span class="kw">FROM</span> `<span class="dv">2017</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>02T03<span class="ch">:04:05</span><span class="op">+</span><span class="dv">07</span><span class="ch">:08</span>`)             <span class="co">-- 3</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true"></a><span class="fu">EXTRACT</span>(<span class="kw">MINUTE</span> <span class="kw">FROM</span> `<span class="dv">2017</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>02T03<span class="ch">:04:05</span><span class="op">+</span><span class="dv">07</span><span class="ch">:08</span>`)           <span class="co">-- 4</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true"></a><span class="fu">EXTRACT</span>(<span class="kw">TIMEZONE_HOUR</span> <span class="kw">FROM</span> `<span class="dv">2017</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>02T03<span class="ch">:04:05</span><span class="op">+</span><span class="dv">07</span><span class="ch">:08</span>`)    <span class="co">-- 7</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true"></a><span class="fu">EXTRACT</span>(<span class="kw">TIMEZONE_MINUTE</span> <span class="kw">FROM</span> `<span class="dv">2017</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>02T03<span class="ch">:04:05</span><span class="op">+</span><span class="dv">07</span><span class="ch">:08</span>`)  <span class="co">-- 8</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true"></a><span class="fu">EXTRACT</span>(<span class="dt">YEAR</span> <span class="kw">FROM</span> <span class="dt">DATE</span> <span class="st">&#39;2010-01-01&#39;</span>)                       <span class="co">-- 2010</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true"></a><span class="fu">EXTRACT</span>(<span class="dt">MONTH</span> <span class="kw">FROM</span> <span class="dt">DATE</span> <span class="st">&#39;2010-01-01&#39;</span>)                      <span class="co">-- 1</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true"></a><span class="fu">EXTRACT</span>(<span class="dt">DAY</span> <span class="kw">FROM</span> <span class="dt">DATE</span> <span class="st">&#39;2010-01-01&#39;</span>)                        <span class="co">-- 1</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true"></a><span class="fu">EXTRACT</span>(<span class="kw">HOUR</span> <span class="kw">FROM</span> <span class="dt">DATE</span> <span class="st">&#39;2010-01-01&#39;</span>)                       <span class="co">-- 0</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true"></a><span class="fu">EXTRACT</span>(<span class="kw">MINUTE</span> <span class="kw">FROM</span> <span class="dt">DATE</span> <span class="st">&#39;2010-01-01&#39;</span>)                     <span class="co">-- 0</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true"></a><span class="fu">EXTRACT</span>(<span class="dt">SECOND</span> <span class="kw">FROM</span> <span class="dt">DATE</span> <span class="st">&#39;2010-01-01&#39;</span>)                     <span class="co">-- 0</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true"></a><span class="fu">EXTRACT</span>(<span class="kw">HOUR</span> <span class="kw">FROM</span> <span class="dt">TIME</span> <span class="st">&#39;23:12:59&#39;</span>)                         <span class="co">-- 23</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true"></a><span class="fu">EXTRACT</span>(<span class="kw">MINUTE</span> <span class="kw">FROM</span> <span class="dt">TIME</span> <span class="st">&#39;23:12:59&#39;</span>)                       <span class="co">-- 12</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true"></a><span class="fu">EXTRACT</span>(<span class="dt">SECOND</span> <span class="kw">FROM</span> <span class="dt">TIME</span> <span class="st">&#39;23:12:59&#39;</span>)                       <span class="co">-- 59</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true"></a><span class="fu">EXTRACT</span>(<span class="dt">SECOND</span> <span class="kw">FROM</span> <span class="dt">TIME</span> (<span class="dv">2</span>) <span class="st">&#39;23:12:59.128&#39;</span>)               <span class="co">-- 59.13</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true"></a><span class="fu">EXTRACT</span>(<span class="kw">TIMEZONE_HOUR</span> <span class="kw">FROM</span> <span class="dt">TIME</span> <span class="kw">WITH</span> <span class="dt">TIME</span> <span class="dt">ZONE</span> <span class="st">&#39;23:12:59-08:30&#39;</span>)    <span class="co">-- -8</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true"></a><span class="fu">EXTRACT</span>(<span class="kw">TIMEZONE_MINUTE</span> <span class="kw">FROM</span> <span class="dt">TIME</span> <span class="kw">WITH</span> <span class="dt">TIME</span> <span class="dt">ZONE</span> <span class="st">&#39;23:12:59-08:30&#39;</span>)  <span class="co">-- -30</span></span></code></pre></div>
<p><em>Note</em> that <code>timezone_hour</code> and <code>timezone_minute</code> are <strong>not supported</strong> for <code>DATE</code> and <code>TIME</code> (without time zone) type.</p>
<h3 id="lower">LOWER</h3>
<p>Given a string convert all upper case characters to lower case characters.</p>
<dl>
<dt>Signature</dt>
<dd><code>LOWER: String -&gt; String</code>
</dd>
<dt>Header</dt>
<dd><code>LOWER(s)</code>
</dd>
<dt>Purpose</dt>
<dd>Given a string, <code>s</code>, alter every upper case character in <code>s</code> to lower case. Any non-upper cased characters remain unchanged. This operation does rely on the locale specified by the runtime configuration. The implementation, currently, relies on Java’s <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html#toLowerCase()">String.toLowerCase()</a> documentation.
</dd>
<dt>Examples</dt>
<dd>
</dd>
</dl>
<div class="sourceCode" id="cb55"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true"></a><span class="fu">LOWER</span>(<span class="st">&#39;AbCdEfG!@#$&#39;</span>) <span class="co">-- &#39;abcdefg!@#$&#39;</span></span></code></pre></div>
<h3 id="make_date">MAKE_DATE</h3>
<p>Given the integer values for the year, month and day returns the associated date.</p>
<dl>
<dt>Signature</dt>
<dd><code>MAKE_DATE: Year_Int Month_Int Day_Int -&gt; Date</code>
</dd>
</dl>
<p>where <code>Year_Int</code>, <code>Month_Int</code>, <code>Day_Int</code> are the Integers representing <code>year</code>, <code>month</code> and <code>day</code> respectively for the date.</p>
<dl>
<dt>Header</dt>
<dd><code>MAKE_DATE(year, month, day)</code>
</dd>
<dt>Purpose</dt>
<dd>Given integer values for <code>year</code>, <code>month</code> and <code>day</code>, returns an associated <code>Date</code>. This function allows arguments to be <code>unknown</code>s i.e. (<code>null</code> or <code>missing</code>).
</dd>
</dl>
<p>Examples :</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true"></a>MAKE_DATE(<span class="dv">2021</span>, <span class="dv">02</span>, <span class="dv">28</span>)                  <span class="co">-- 2021-02-28</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true"></a>MAKE_DATE(<span class="dv">2020</span>, <span class="dv">02</span>, <span class="dv">29</span>)                  <span class="co">-- 2020-02-29</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true"></a>MAKE_DATE(<span class="dv">2021</span>, <span class="dv">12</span>, <span class="dv">31</span>)                  <span class="co">-- 2021-12-31</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true"></a>MAKE_DATE(<span class="kw">null</span>, <span class="dv">02</span>, <span class="dv">28</span>)                  <span class="co">-- null</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true"></a>MAKE_DATE(<span class="dv">2021</span>, <span class="kw">null</span>, <span class="dv">28</span>)                <span class="co">-- null</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true"></a>MAKE_DATE(<span class="dv">2021</span>, <span class="dv">02</span>, <span class="kw">null</span>)                <span class="co">-- null</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true"></a>MAKE_DATE(missing, <span class="dv">02</span>, <span class="dv">28</span>)               <span class="co">-- null</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true"></a>MAKE_DATE(<span class="dv">2021</span>, missing, <span class="dv">28</span>)             <span class="co">-- null</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true"></a>MAKE_DATE(<span class="dv">2021</span>, <span class="dv">02</span>, missing)             <span class="co">-- null</span></span></code></pre></div>
<h3 id="make_time">MAKE_TIME</h3>
<p>Given the values for the hour (int), minute (int), second (BigDecimal) and optionally for timezone minutes (int) returns the associated time.</p>
<dl>
<dt>Signature</dt>
<dd><code>MAKE_TIME: Hour_Int Minute_Int Second_BigDecimal (optional)TimezoneMinutes_Int -&gt; Time</code>
</dd>
</dl>
<p>where <code>Hour_Int</code>, <code>Minute_Int</code>, <code>TimezoneMinutes_Int</code> are the Integers representing <code>hour</code>, <code>minute</code> and <code>timezone minutes</code> respectively for the time. <code>Second_BigDecimal</code> is the BigDecimal representing the <code>second</code> with fraction of the time.</p>
<dl>
<dt>Header</dt>
<dd><code>MAKE_TIME(hour, minute, second, timezoneMinutes?)</code>
</dd>
<dt>Purpose</dt>
<dd>Given values for <code>hour</code> (int), <code>minute</code> (int), <code>second</code> (BigDecimal) and optionally for <code>timezone minutes</code> (int), returns an associated <code>Time</code>. This function allows arguments to be <code>unknown</code>s i.e. (<code>null</code> or <code>missing</code>).
</dd>
</dl>
<p>Examples :</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true"></a>MAKE_TIME(<span class="dv">23</span>, <span class="dv">59</span>, <span class="fl">59.</span>)                   <span class="co">-- 23:59:59</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true"></a>MAKE_TIME(<span class="dv">23</span>, <span class="dv">59</span>, <span class="fl">59.12345</span>, <span class="dv">330</span>)         <span class="co">-- 23:59:59.12345+05:30</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true"></a>MAKE_TIME(<span class="dv">23</span>, <span class="dv">59</span>, <span class="fl">59.12345</span>, <span class="op">-</span><span class="dv">330</span>)        <span class="co">-- 23:59:59.12345-05:30</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true"></a>MAKE_TIME(<span class="kw">null</span>, <span class="dv">02</span>, <span class="fl">28.</span>)                 <span class="co">-- null</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true"></a>MAKE_TIME(<span class="dv">12</span>, <span class="kw">null</span>, <span class="fl">28.</span>)                 <span class="co">-- null</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true"></a>MAKE_TIME(<span class="dv">21</span>, <span class="dv">02</span>, <span class="kw">null</span>)                  <span class="co">-- null</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true"></a>MAKE_TIME(missing, <span class="dv">02</span>, <span class="fl">28.</span>)              <span class="co">-- null</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true"></a>MAKE_TIME(<span class="dv">23</span>, missing, <span class="fl">59.</span>)              <span class="co">-- null</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true"></a>MAKE_TIME(<span class="dv">21</span>, <span class="dv">02</span>, missing)               <span class="co">-- null</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true"></a>MAKE_TIME(<span class="dv">21</span>, <span class="dv">02</span>, <span class="fl">28.</span>, <span class="kw">null</span>)             <span class="co">-- null</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true"></a>MAKE_TIME(<span class="dv">21</span>, <span class="dv">02</span>, <span class="fl">28.</span>, missing)          <span class="co">-- null</span></span></code></pre></div>
<h3 id="size">SIZE</h3>
<p>Given any container data type (i.e., list, structure or bag) return the number of elements in the container.</p>
<dl>
<dt>Signature</dt>
<dd><code>SIZE: Container -&gt; Integer</code>
</dd>
<dt>Header</dt>
<dd><code>SIZE(c)</code>
</dd>
<dt>Purpose</dt>
<dd>Given a container, <code>c</code>, return the number of elements in the container. If the input to <code>SIZE</code> is not a container the implementation throws an error.
</dd>
<dt>Examples</dt>
<dd>
</dd>
</dl>
<div class="sourceCode" id="cb58"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true"></a><span class="kw">SIZE</span>(`[]`)                   <span class="co">-- 0</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true"></a><span class="kw">SIZE</span>(`[<span class="kw">null</span>]`)               <span class="co">-- 1</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true"></a><span class="kw">SIZE</span>(`[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]`)              <span class="co">-- 3</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true"></a><span class="kw">SIZE</span>(<span class="op">&lt;&lt;</span><span class="st">&#39;foo&#39;</span>, <span class="st">&#39;bar&#39;</span><span class="op">&gt;&gt;</span>)       <span class="co">-- 2</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true"></a><span class="kw">SIZE</span>(`{foo: bar}`)           <span class="co">-- 1 (number of key-value pairs)</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true"></a><span class="kw">SIZE</span>(`[{foo: <span class="dv">1</span>}, {foo: <span class="dv">2</span>}]`) <span class="co">-- 2</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true"></a><span class="kw">SIZE</span>(<span class="dv">12</span>)                     <span class="co">-- error</span></span></code></pre></div>
<h3 id="nullif">NULLIF</h3>
<p>Given two expressions return <code>null</code> if the two expressions evaluate to the same value, else, returns the result of evaluating the first expression</p>
<dl>
<dt>Signature</dt>
<dd><code>NULLIF: Any Any -&gt; Any</code>
</dd>
<dt>Header</dt>
<dd><code>NULLIF(e1, e2)</code>
</dd>
<dt>Purpose</dt>
<dd>Given two expression, <code>e1</code> and <code>e2</code>, evaluate both expression to get <code>v1</code> and <code>v2</code> respectively, and return <code>null</code> if and only if <code>v1</code> equals <code>v2</code>, else, return <code>v1</code>. The implementation of <code>NULLIF</code> uses <code>=</code> for equality, i.e., <code>v1</code> and <code>v2</code> are considered equal by <code>NULLIF</code> if and only if <code>v1 = v2</code> is true.
</dd>
</dl>
<p><em>Note</em>, <code>NULLIF</code> does <strong>not</strong> propagate unknowns (<code>null</code> and <code>missing</code>).</p>
<dl>
<dt>Examples</dt>
<dd>
</dd>
</dl>
<div class="sourceCode" id="cb59"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true"></a><span class="fu">NULLIF</span>(<span class="dv">1</span>, <span class="dv">1</span>)             <span class="co">-- null</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true"></a><span class="fu">NULLIF</span>(<span class="dv">1</span>, <span class="dv">2</span>)             <span class="co">-- 1</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true"></a><span class="fu">NULLIF</span>(<span class="fl">1.0</span>, <span class="dv">1</span>)           <span class="co">-- null</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true"></a><span class="fu">NULLIF</span>(<span class="dv">1</span>, <span class="st">&#39;1&#39;</span>)           <span class="co">-- 1</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true"></a><span class="fu">NULLIF</span>([<span class="dv">1</span>], [<span class="dv">1</span>])         <span class="co">-- null</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true"></a><span class="fu">NULLIF</span>(<span class="dv">1</span>, <span class="kw">NULL</span>)          <span class="co">-- 1</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true"></a><span class="fu">NULLIF</span>(<span class="kw">NULL</span>, <span class="dv">1</span>)          <span class="co">-- null</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true"></a><span class="fu">NULLIF</span>(<span class="kw">null</span>, <span class="kw">null</span>)       <span class="co">-- null</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true"></a><span class="fu">NULLIF</span>(missing, <span class="kw">null</span>)    <span class="co">-- null</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true"></a><span class="fu">NULLIF</span>(missing, missing) <span class="co">-- null</span></span></code></pre></div>
<h3 id="substring">SUBSTRING</h3>
<p>Given a string, a start index and optionally a length, returns the substring from the start index up to the end of the string, or, up to the length provided.</p>
<dl>
<dt>Signature</dt>
<dd><code>SUBSTRING: String Integer [ NNegInteger ] -&gt; String</code>
</dd>
</dl>
<p>Where <code>NNegInteger</code> is a non-negative integer, i.e., 0 or greater.</p>
<dl>
<dt>Header</dt>
<dd><code>SUBSTRING(str, start [ , length ])</code>
</dd>
</dl>
<p><code>SUBSTRING(str FROM start [ FOR  length ])</code></p>
<dl>
<dt>Purpose</dt>
<dd>Given a string, <code>str</code>, a start position, <code>start</code> and optionally a length, <code>length</code>, extract the characters (code points) starting at index <code>start</code> and ending at (<code>start</code> + <code>length</code>) - 1. If <code>length</code> is omitted, then proceed till the end of <code>str</code>.
</dd>
</dl>
<p>The first character of <code>str</code> has index 1.</p>
<dl>
<dt>Examples</dt>
<dd>
</dd>
</dl>
<div class="sourceCode" id="cb60"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true"></a>SUBSTRING(<span class="ot">&quot;123456789&quot;</span>, <span class="dv">0</span>)      <span class="co">-- &quot;123456789&quot;</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true"></a>SUBSTRING(<span class="ot">&quot;123456789&quot;</span>, <span class="dv">1</span>)      <span class="co">-- &quot;123456789&quot;</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true"></a>SUBSTRING(<span class="ot">&quot;123456789&quot;</span>, <span class="dv">2</span>)      <span class="co">-- &quot;23456789&quot;</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true"></a>SUBSTRING(<span class="ot">&quot;123456789&quot;</span>, <span class="op">-</span><span class="dv">4</span>)     <span class="co">-- &quot;123456789&quot;</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true"></a>SUBSTRING(<span class="ot">&quot;123456789&quot;</span>, <span class="dv">0</span>, <span class="dv">999</span>) <span class="co">-- &quot;123456789&quot; </span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true"></a>SUBSTRING(<span class="ot">&quot;123456789&quot;</span>, <span class="dv">0</span>, <span class="dv">2</span>)   <span class="co">-- &quot;1&quot;</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true"></a>SUBSTRING(<span class="ot">&quot;123456789&quot;</span>, <span class="dv">1</span>, <span class="dv">999</span>) <span class="co">-- &quot;123456789&quot;</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true"></a>SUBSTRING(<span class="ot">&quot;123456789&quot;</span>, <span class="dv">1</span>, <span class="dv">2</span>)   <span class="co">-- &quot;12&quot;</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true"></a>SUBSTRING(<span class="ot">&quot;1&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)           <span class="co">-- &quot;&quot;</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true"></a>SUBSTRING(<span class="ot">&quot;1&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)           <span class="co">-- &quot;&quot;</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true"></a>SUBSTRING(<span class="ot">&quot;1&quot;</span>, <span class="op">-</span><span class="dv">4</span>, <span class="dv">0</span>)          <span class="co">-- &quot;&quot;</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true"></a>SUBSTRING(<span class="ot">&quot;1234&quot;</span>, <span class="dv">10</span>, <span class="dv">10</span>)      <span class="co">-- &quot;&quot;</span></span></code></pre></div>
<h3 id="to_string">TO_STRING</h3>
<p>Given a timestamp and a format pattern return a string representation of the timestamp in the given format.</p>
<dl>
<dt>Signature</dt>
<dd><code>TO_STRING: Timestamp TimeFormatPattern -&gt; String</code>
</dd>
</dl>
<p>Where <code>TimeFormatPattern</code> is a String with the following special character interpretations</p>
<table>
<colgroup>
<col style="width: 16%" />
<col style="width: 11%" />
<col style="width: 72%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Format</th>
<th style="text-align: left;">Example</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>yy</code></td>
<td style="text-align: left;">69</td>
<td style="text-align: left;">2-digit year</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>y</code></td>
<td style="text-align: left;">1969</td>
<td style="text-align: left;">4-digit year</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>yyyy</code></td>
<td style="text-align: left;">1969</td>
<td style="text-align: left;">Zero padded 4-digit year</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>M</code></td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Month of year</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>MM</code></td>
<td style="text-align: left;">01</td>
<td style="text-align: left;">Zero padded month of year</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>MMM</code></td>
<td style="text-align: left;">Jan</td>
<td style="text-align: left;">Abbreviated month year name</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>MMMM</code></td>
<td style="text-align: left;">January</td>
<td style="text-align: left;">Full month of year name</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>MMMMM</code></td>
<td style="text-align: left;">J</td>
<td style="text-align: left;">Month of year first letter (NOTE: not valid for use with to_timestamp function)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>d</code></td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Day of month (1-31)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>dd</code></td>
<td style="text-align: left;">02</td>
<td style="text-align: left;">Zero padded day of month (01-31)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>a</code></td>
<td style="text-align: left;">AM</td>
<td style="text-align: left;">AM or PM of day</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>h</code></td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">Hour of day (1-12)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>hh</code></td>
<td style="text-align: left;">03</td>
<td style="text-align: left;">Zero padded hour of day (01-12)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>H</code></td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">Hour of day (0-23)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>HH</code></td>
<td style="text-align: left;">03</td>
<td style="text-align: left;">Zero padded hour of day (00-23)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>m</code></td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Minute of hour (0-59)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>mm</code></td>
<td style="text-align: left;">04</td>
<td style="text-align: left;">Zero padded minute of hour (00-59)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s</code></td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Second of minute (0-59)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>ss</code></td>
<td style="text-align: left;">05</td>
<td style="text-align: left;">Zero padded second of minute (00-59)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>S</code></td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">Fraction of second (precision: 0.1, range: 0.0-0.9)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>SS</code></td>
<td style="text-align: left;">06</td>
<td style="text-align: left;">Fraction of second (precision: 0.01, range: 0.0-0.99)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>SSS</code></td>
<td style="text-align: left;">060</td>
<td style="text-align: left;">Fraction of second (precision: 0.001, range: 0.0-0.999)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">…</td>
<td style="text-align: left;">…</td>
<td style="text-align: left;">…</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>SSSSSSSSS</code></td>
<td style="text-align: left;">060000000</td>
<td style="text-align: left;">Fraction of second (maximum precision: 1 nanosecond, range: 0.0-0.999999999)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>n</code></td>
<td style="text-align: left;">60000000</td>
<td style="text-align: left;">Nano of second</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>X</code></td>
<td style="text-align: left;">+07 or Z</td>
<td style="text-align: left;">Offset in hours or “Z” if the offset is 0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>XX</code> or <code>XXXX</code></td>
<td style="text-align: left;">+0700 or Z</td>
<td style="text-align: left;">Offset in hours and minutes or “Z” if the offset is 0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>XXX</code> or <code>XXXXX</code></td>
<td style="text-align: left;">+07:00 or Z</td>
<td style="text-align: left;">Offset in hours and minutes or “Z” if the offset is 0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>x</code></td>
<td style="text-align: left;">+07</td>
<td style="text-align: left;">Offset in hours</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>xx</code> or <code>xxxx</code></td>
<td style="text-align: left;">+0700</td>
<td style="text-align: left;">Offset in hours and minutes</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>xxx</code> or <code>xxxxx</code></td>
<td style="text-align: left;">+07:00</td>
<td style="text-align: left;">Offset in hours and minutes</td>
</tr>
</tbody>
</table>
<dl>
<dt>Header</dt>
<dd><code>TO_STRING(t,f)</code>
</dd>
<dt>Purpose</dt>
<dd>Given a timestamp, <code>t</code>, and a format pattern, <code>f</code>, as a String, return a string representation of <code>t</code> in format <code>f</code>.
</dd>
<dt>Examples</dt>
<dd>
</dd>
</dl>
<div class="sourceCode" id="cb61"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true"></a>TO_STRING(`<span class="dv">1969</span><span class="op">-</span><span class="dv">07</span><span class="op">-</span>20T20<span class="ch">:18Z</span>`,  <span class="st">&#39;MMMM d, y&#39;</span>)                    <span class="co">-- &quot;July 20, 1969&quot;</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true"></a>TO_STRING(`<span class="dv">1969</span><span class="op">-</span><span class="dv">07</span><span class="op">-</span>20T20<span class="ch">:18Z</span>`, <span class="st">&#39;MMM d, yyyy&#39;</span>)                   <span class="co">-- &quot;Jul 20, 1969&quot;</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true"></a>TO_STRING(`<span class="dv">1969</span><span class="op">-</span><span class="dv">07</span><span class="op">-</span>20T20<span class="ch">:18Z</span>`, <span class="st">&#39;M-d-yy&#39;</span>)                        <span class="co">-- &quot;7-20-69&quot;</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true"></a>TO_STRING(`<span class="dv">1969</span><span class="op">-</span><span class="dv">07</span><span class="op">-</span>20T20<span class="ch">:18Z</span>`, <span class="st">&#39;MM-d-y&#39;</span>)                        <span class="co">-- &quot;07-20-1969&quot;</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true"></a>TO_STRING(`<span class="dv">1969</span><span class="op">-</span><span class="dv">07</span><span class="op">-</span>20T20<span class="ch">:18Z</span>`, <span class="st">&#39;MMMM d, y h:m a&#39;</span>)               <span class="co">-- &quot;July 20, 1969 8:18 PM&quot;</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true"></a>TO_STRING(`<span class="dv">1969</span><span class="op">-</span><span class="dv">07</span><span class="op">-</span>20T20<span class="ch">:18Z</span>`, <span class="st">&#39;y-MM-dd</span><span class="ch">&#39;&#39;</span><span class="st">T</span><span class="ch">&#39;&#39;</span><span class="st">H:m:ssX&#39;</span>)           <span class="co">-- &quot;1969-07-20T20:18:00Z&quot;</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true"></a>TO_STRING(`<span class="dv">1969</span><span class="op">-</span><span class="dv">07</span><span class="op">-</span>20T20<span class="ch">:18</span><span class="op">+</span><span class="dv">08</span><span class="ch">:00Z</span>`, <span class="st">&#39;y-MM-dd</span><span class="ch">&#39;&#39;</span><span class="st">T</span><span class="ch">&#39;&#39;</span><span class="st">H:m:ssX&#39;</span>)     <span class="co">-- &quot;1969-07-20T20:18:00Z&quot;</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true"></a>TO_STRING(`<span class="dv">1969</span><span class="op">-</span><span class="dv">07</span><span class="op">-</span>20T20<span class="ch">:18</span><span class="op">+</span><span class="dv">08</span><span class="ch">:00</span>`, <span class="st">&#39;y-MM-dd</span><span class="ch">&#39;&#39;</span><span class="st">T</span><span class="ch">&#39;&#39;</span><span class="st">H:m:ssXXXX&#39;</span>)   <span class="co">-- &quot;1969-07-20T20:18:00+0800&quot;</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true"></a>TO_STRING(`<span class="dv">1969</span><span class="op">-</span><span class="dv">07</span><span class="op">-</span>20T20<span class="ch">:18</span><span class="op">+</span><span class="dv">08</span><span class="ch">:00</span>`, <span class="st">&#39;y-MM-dd</span><span class="ch">&#39;&#39;</span><span class="st">T</span><span class="ch">&#39;&#39;</span><span class="st">H:m:ssXXXXX&#39;</span>)  <span class="co">-- &quot;1969-07-20T20:18:00+08:00&quot;</span></span></code></pre></div>
<h3 id="to_timestamp">TO_TIMESTAMP</h3>
<p>Given a string convert it to a timestamp. This is the inverse operation of <a href="#to_string"><code>TO_STRING</code></a></p>
<dl>
<dt>Signature</dt>
<dd><code>TO_TIMESTAMP: String [ TimeFormatPattern ] -&gt; Timestamp</code>
</dd>
</dl>
<p>See definition of <code>TimeFormatPattern</code> in <a href="#to_string">TO_STRING</a>.</p>
<dl>
<dt>Header</dt>
<dd><code>TO_TIMESTAMP(str[ , f ])</code>
</dd>
<dt>Purpose</dt>
<dd>Given a string, <code>str</code>, and an optional format pattern, <code>f</code>, as a String return a timestamp whose values are extracted from <code>str</code> using <code>f</code>.
</dd>
</dl>
<p>If the <code>&lt;format pattern&gt;</code> argument is omitted, <code>&lt;string&gt;</code> is assumed to be in the format of a <a href="https://amzn.github.io/ion-docs/spec.html#timestamp">standard Ion timestamp</a>. This is the only recommended way to parse an Ion timestamp using this function.</p>
<p>Zero padding is optional when using a single format symbol (e.g. <code>y</code>, <code>M</code>, <code>d</code>, <code>H</code>, <code>h</code>, <code>m</code>, <code>s</code>) but required for their zero padded variants (e.g. <code>yyyy</code>, <code>MM</code>, <code>dd</code>, <code>HH</code>, <code>hh</code>, <code>mm</code>, <code>ss</code>).</p>
<p>Special treatment is given to 2-digit years (format symbol <code>yy</code>). 1900 is added to values greater than or equal to 70 and 2000 is added to values less than 70.</p>
<p>Month names and AM/PM specifiers are case-insensitive.</p>
<dl>
<dt>Examples</dt>
<dd>
</dd>
</dl>
<p>Single argument parsing an Ion timestamp:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true"></a><span class="fu">TO_TIMESTAMP</span>(<span class="st">&#39;2007T&#39;</span>)                         <span class="co">-- `2007T`</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true"></a><span class="fu">TO_TIMESTAMP</span>(<span class="st">&#39;2007-02-23T12:14:33.079-08:00&#39;</span>) <span class="co">-- `2007-02-23T12:14:33.079-08:00`</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true"></a><span class="fu">TO_TIMESTAMP</span>(<span class="st">&#39;2016&#39;</span>, <span class="st">&#39;y&#39;</span>)                     <span class="co">-- `2016T`</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true"></a><span class="fu">TO_TIMESTAMP</span>(<span class="st">&#39;2016&#39;</span>, <span class="st">&#39;yyyy&#39;</span>)                  <span class="co">-- `2016T`</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true"></a><span class="fu">TO_TIMESTAMP</span>(<span class="st">&#39;02-2016&#39;</span>, <span class="st">&#39;MM-yyyy&#39;</span>)            <span class="co">-- `2016-02T`</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true"></a><span class="fu">TO_TIMESTAMP</span>(<span class="st">&#39;Feb 2016&#39;</span>, <span class="st">&#39;MMM yyyy&#39;</span>)          <span class="co">-- `2016-02T`</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true"></a><span class="fu">TO_TIMESTAMP</span>(<span class="st">&#39;Febrary 2016&#39;</span>, <span class="st">&#39;MMMM yyyy&#39;</span>)     <span class="co">-- `2016-02T`</span></span></code></pre></div>
<p>Notes:</p>
<p><a href="https://github.com/partiql/partiql-lang-kotlin/issues?utf8=%E2%9C%93&amp;q=is%3Aissue+is%3Aopen+TO_TIMESTAMP+">All issues for PartiQL’s <code>TO_TIMESTAMP</code> function</a>.</p>
<p>Internally, this is implemented with Java 8’s <code>java.time</code> package. There are a few differences between Ion’s timestamp and the <code>java.time</code> package that create a few hypothetically infrequently encountered caveats that do not really have good workarounds at this time.</p>
<ul>
<li>The Ion specification allows for explicitly signifying an unknown timestamp with a negative zero offset (i.e. the <code>-00:00</code> at the end of <code>2007-02-23T20:14:33.079-00:00</code>) but Java 8’s <code>DateTimeFormatter</code> doesn’t recognize this. <strong>Hence, unknown offsets specified in this manner will be parsed as if they had an offset of <code>+00:00</code>, i.e. UTC.</strong> To avoid this issue when parsing Ion formatted timestamps, use the single argument variant of <code>TO_TIMESTAMP</code>. There is no workaround for custom format patterns at this time.</li>
<li><code>DateTimeFormatter</code> is capable of parsing UTC offsets to the precision of seconds, but Ion Timestamp’s precision for offsets is minutes. TimestampParser currently handles this by throwing an exception when an attempt is made to parse a timestamp with an offset that does does not land on a minute boundary. For example, parsing this timestamp would throw an exception: <code>May 5, 2017 8:52pm +08:00:01</code> while <code>May 5, 2017 8:52pm +08:00:00</code> would not.</li>
<li>Ion Java’s Timestamp allows specification of offsets up to +/- 23:59, while an exception is thrown by <code>DateTimeFormatter</code> for any attempt to parse an offset greater than +/- 18:00. For example, attempting to parse: <code>May 5, 2017 8:52pm +18:01</code> would cause and exception to be thrown. (Note: the Ion specification does indicate minimum and maximum allowable values for offsets.) In practice this will not be an issue for systems that do not abuse the offset portion of Timestamp because real-life offsets do not exceed +/- 12h.</li>
</ul>
<h3 id="trim">TRIM</h3>
<p>Trims leading and/or trailing characters from a String.</p>
<dl>
<dt>Signature</dt>
<dd><code>TRIM: [ String ] String -&gt; String</code>
</dd>
<dt>Header</dt>
<dd><code>TRIM([[LEADING|TRAILING|BOTH r] FROM] str)</code>
</dd>
<dt>Purpose</dt>
<dd>Given a string, <code>str</code>, and an optional <em>set</em> of characters to remove, <code>r</code>, specified as a string, return the string with any character from <code>r</code> found at the beginning or end of <code>str</code> removed.
</dd>
</dl>
<p>If <code>r</code> is not provided it defaults to <code>' '</code>.</p>
<dl>
<dt>Examples</dt>
<dd>
</dd>
</dl>
<div class="sourceCode" id="cb63"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true"></a><span class="fu">TRIM</span>(<span class="st">&#39;       foobar         &#39;</span>)               <span class="co">-- &#39;foobar&#39;</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true"></a><span class="fu">TRIM</span>(<span class="st">&#39;      </span><span class="ch">\t</span><span class="st">foobar</span><span class="ch">\t</span><span class="st">         &#39;</span>)            <span class="co">-- &#39;\tfoobar\t&#39;</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true"></a><span class="fu">TRIM</span>(<span class="kw">LEADING</span> <span class="kw">FROM</span> <span class="st">&#39;       foobar         &#39;</span>)  <span class="co">-- &#39;foobar         &#39;</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true"></a><span class="fu">TRIM</span>(<span class="kw">TRAILING</span> <span class="kw">FROM</span> <span class="st">&#39;       foobar         &#39;</span>) <span class="co">-- &#39;       foobar&#39;</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true"></a><span class="fu">TRIM</span>(<span class="kw">BOTH</span> <span class="kw">FROM</span> <span class="st">&#39;       foobar         &#39;</span>)     <span class="co">-- &#39;foobar&#39;</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true"></a><span class="fu">TRIM</span>(<span class="kw">BOTH</span> <span class="st">&#39;😁&#39;</span> <span class="kw">FROM</span> <span class="st">&#39;😁😁foobar😁😁&#39;</span>)         <span class="co">-- &#39;foobar&#39;</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true"></a><span class="fu">TRIM</span>(<span class="kw">BOTH</span> <span class="st">&#39;12&#39;</span> <span class="kw">FROM</span> <span class="st">&#39;1112211foobar22211122&#39;</span>) <span class="co">-- &#39;foobar&#39;</span></span></code></pre></div>
<h3 id="upper">UPPER</h3>
<p>Given a string convert all lower case characters to upper case characters.</p>
<dl>
<dt>Signature</dt>
<dd><code>UPPER: String -&gt; String</code>
</dd>
<dt>Header</dt>
<dd><code>UPPER(str)</code>
</dd>
<dt>Purpose</dt>
<dd>Given a string, <code>str</code>, alter every upper case character is <code>str</code> to lower case. Any non-lower cases characters remain unchanged. This operation does rely on the locale specified by the runtime configuration. The implementation, currently, relies on Java’s <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html#toLowerCase()">String.toLowerCase()</a> documentation.
</dd>
<dt>Examples</dt>
<dd>
</dd>
</dl>
<div class="sourceCode" id="cb64"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true"></a><span class="fu">UPPER</span>(<span class="st">&#39;AbCdEfG!@#$&#39;</span>) <span class="co">-- &#39;ABCDEFG!@#$&#39;</span></span></code></pre></div>
<h3 id="utcnow">UTCNOW</h3>
<p>Returns the current time in UTC as a timestamp.</p>
<dl>
<dt>Signature</dt>
<dd><code>UTCNOW:  -&gt; Timestamp</code>
</dd>
<dt>Header</dt>
<dd><code>UTCNOW()</code>
</dd>
<dt>Purpose</dt>
<dd>Return the current time in UTC as a timestamp
</dd>
<dt>Examples</dt>
<dd>
</dd>
</dl>
<div class="sourceCode" id="cb65"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true"></a>UTCNOW() <span class="co">-- 2017-10-13T16:02:11.123Z </span></span></code></pre></div>
<h3 id="unix_timestamp">UNIX_TIMESTAMP</h3>
<p>With no <code>timestamp</code> argument, returns the number of seconds since the last epoch (‘1970-01-01 00:00:00’ UTC).</p>
<p>With a <code>timestamp</code> argument, returns the number of seconds from the last epoch to the given <code>timestamp</code> (possibly negative).</p>
<p>Signature : <code>UNIX_TIMESTAMP: [Timestamp] -&gt; Integer|Decimal</code></p>
<p>Header : <code>UNIX_TIMESTAMP([timestamp])</code></p>
<p>Purpose : <code>UNIX_TIMESTAMP()</code> called without a <code>timestamp</code> argument returns the number of whole seconds since the last epoch (‘1970-01-01 00:00:00’ UTC) as an Integer using <code>UTCNOW</code>.</p>
<p><code>UNIX_TIMESTAMP()</code> called with a <code>timestamp</code> argument returns returns the number of seconds from the last epoch to the <code>timestamp</code> argument. If given a <code>timestamp</code> before the last epoch, <code>UNIX_TIMESTAMP</code> will return the number of seconds before the last epoch as a negative number. The return value will be a Decimal if and only if the given <code>timestamp</code> has a fractional seconds part.</p>
<p>Examples :</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true"></a>UNIX_TIMESTAMP()                            <span class="co">-- 1507910531 (if current time is `2017-10-13T16:02:11Z`; # of seconds since last epoch as an Integer)</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true"></a>UNIX_TIMESTAMP(`2020T`)                     <span class="co">-- 1577836800 (seconds from 2020 to the last epoch as an Integer)</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true"></a>UNIX_TIMESTAMP(`<span class="dv">2020</span><span class="op">-</span>01T`)                  <span class="co">-- &#39;&#39;</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true"></a>UNIX_TIMESTAMP(`<span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>01T`)               <span class="co">-- &#39;&#39;</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true"></a>UNIX_TIMESTAMP(`<span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>01T00<span class="ch">:00Z</span>`)         <span class="co">-- &#39;&#39;</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true"></a>UNIX_TIMESTAMP(`<span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>01T00<span class="ch">:00:00Z</span>`)      <span class="co">-- &#39;&#39;</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true"></a>UNIX_TIMESTAMP(`<span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>01T00<span class="ch">:00:00</span><span class="fl">.0</span>Z`)    <span class="co">-- 1577836800. (seconds from 2020 to the last epoch as a Decimal)</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true"></a>UNIX_TIMESTAMP(`<span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>01T00<span class="ch">:00:00</span><span class="fl">.00</span>Z`)   <span class="co">-- &#39;&#39;</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true"></a>UNIX_TIMESTAMP(`<span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>01T00<span class="ch">:00:00</span><span class="fl">.000</span>Z`)  <span class="co">-- &#39;&#39;</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true"></a>UNIX_TIMESTAMP(`<span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span>01T00<span class="ch">:00:00</span><span class="fl">.100</span>Z`)  <span class="co">-- 1577836800.1</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true"></a>UNIX_TIMESTAMP(`1969T`)                     <span class="co">-- -31536000 (timestamp is before last epoch)</span></span></code></pre></div>
<h3 id="from_unixtime">FROM_UNIXTIME</h3>
<p>Converts the given unix epoch into a timestamp.</p>
<p>Signature : <code>FROM_UNIXTIME: Integer|Decimal -&gt; Timestamp</code></p>
<p>Header : <code>FROM_UNIXTIME(unix_timestamp)</code></p>
<p>Purpose : When given a non-negative numeric value, returns a timestamp after the last epoch. When given a negative numeric value, returns a timestamp before the last epoch. The returned timestamp has fractional seconds depending on if the value is a decimal.</p>
<p>Examples :</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true"></a>FROM_UNIXTIME(<span class="op">-</span><span class="dv">1</span>)           <span class="co">-- `1969-12-31T23:59:59-00:00`      (negative unix_timestamp; returns timestamp before last epoch)</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true"></a>FROM_UNIXTIME(<span class="op">-</span><span class="fl">0.1</span>)         <span class="co">-- `1969-12-31T23:59:59.9-00:00`    (unix_timestamp is decimal so timestamp has fractional seconds)</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true"></a>FROM_UNIXTIME(<span class="dv">0</span>)            <span class="co">-- `1970-01-01T00:00:00.000-00:00`</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true"></a>FROM_UNIXTIME(<span class="fl">0.001</span>)        <span class="co">-- `1970-01-01T00:00:00.001-00:00`  (decimal precision to fractional second precision) </span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true"></a>FROM_UNIXTIME(<span class="fl">0.01</span>)         <span class="co">-- `1970-01-01T00:00:00.01-00:00`</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true"></a>FROM_UNIXTIME(<span class="fl">0.1</span>)          <span class="co">-- `1970-01-01T00:00:00.1-00:00`</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true"></a>FROM_UNIXTIME(<span class="dv">1</span>)            <span class="co">-- `1970-01-01T00:00:01-00:00`</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true"></a>FROM_UNIXTIME(<span class="dv">1577836800</span>)   <span class="co">-- `2020-01-01T00:00:00-00:00`      (unix_timestamp is Integer so no fractional seconds)</span></span></code></pre></div>
<h1 class="unnumbered" id="references">References</h1>
<div id="refs" class="references" role="doc-bibliography">
<div id="ref-IonSpec">
<p>[1] Ion Committee, “Ion Specification 1.0,” 2009. [Online]. Available: <a href="https://amzn.github.io/ion-docs/spec.html">https://amzn.github.io/ion-docs/spec.html</a>.</p>
</div>
</div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>The file will append PartiQL’s release version to the archive, i.e., <code>partiql-cli-0.1.0.zip</code>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>The folder name will have the PartiQL version as a suffix, i.e., <code>partiql-cli-0.1.0</code>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>                    
                </div>
            </div>

        </div>
    </body>
</html>
